<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#0078E7"><meta name="author" content="xudaxia"><meta name="copyright" content="xudaxia"><meta name="generator" content="Hexo 5.2.0"><meta name="theme" content="hexo-theme-yun"><title>æœ€çŸ­è·¯ | xudaxiaçš„åšå®¢</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/star-markdown-css@0.1.22/dist/yun/yun-markdown.min.css"><script src="//at.alicdn.com/t/font_1140697_ed8vp4atwoj.js" async></script><script src="https://cdn.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>document.addEventListener("DOMContentLoaded", () => {
  [".post-card",".post-content img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
});
</script><link id="light-prism-css" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.20.0/themes/prism.css" media="(prefers-color-scheme: light)"><link id="dark-prism-css" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.20.0/themes/prism-tomorrow.css" media="(prefers-color-scheme: dark)"><link rel="shortcut icon" type="image/svg+xml" href="/yun.svg"><link rel="mask-icon" href="/yun.svg" color="#0078E7"><link rel="alternate icon" href="/yun.ico"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="preload" href="/js/utils.js" as="script"><link rel="preload" href="/js/hexo-theme-yun.js" as="script"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script id="yun-config">
    const Yun = window.Yun || {};
    window.CONFIG = {"hostname":"example.com","root":"/","title":"Xu-DaXia-C","version":"1.3.0","mode":"auto","copycode":true,"anonymous_image":"https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/avatar/none.jpg","say":{"api":"/data/sentences.json"},"fireworks":{"colors":["102, 167, 221","62, 131, 225","33, 78, 194"]}};
  </script><meta name="description" content="æœ€çŸ­è·¯æœ€çŸ­è·¯æ˜¯å›¾è®ºä¸­æœ€åŸºæœ¬çš„ä¸€ç±»é—®é¢˜ã€‚å¯ä»¥åˆ†ä¸ºå•æºæœ€çŸ­è·¯å’Œå¤šæºæœ€çŸ­è·¯ä¸¤ç±»ã€‚ å•æºæœ€çŸ­è·¯Dijkstraæœ€é«˜æ•ˆçš„æœ€çŸ­è·¯ç®—æ³•ï¼Œä½†æ˜¯ä¸èƒ½å¤„ç†æœ‰è´Ÿè¾¹æƒçš„å›¾ã€‚å…¶æœ¬è´¨æ˜¯ä¸æ–­è´ªå¿ƒã€‚ è€ƒè™‘ä»¥æŸä¸€ç‚¹uä¸ºèµ·ç‚¹çš„æœ€çŸ­è·¯ã€‚ æ£€æŸ¥ä»è¿™ä¸€ç‚¹çš„æ‰€æœ‰å‡ºè¾¹ï¼Œè®¾çŸ­çš„é‚£æ¡å‡ºè¾¹ä¸ºeã€‚æ˜¾ç„¶åˆ°eçš„ç»ˆç‚¹ï¼ˆè®¾ä¸ºvï¼‰çš„æœ€çŸ­è·¯å·²ç»ç¡®å®šï¼Œé•¿åº¦å°±æ˜¯eçš„é•¿åº¦wã€‚å› ä¸ºè‹¥æœ‰å…¶ä»–çš„æœ€çŸ­è·¯ï¼Œå…¶å¿…ç„¶åŒ…å«ä¸æ˜¯eçš„å…¶ä»–å‡ºè¾¹ï¼Œåˆå› ä¸ºå› ä¸ºeæ˜¯æœ€çŸ­çš„å‡ºè¾¹ï¼Œæ‰€ä»¥åŒ…å«éeè¾¹çš„è¿™">
<meta property="og:type" content="article">
<meta property="og:title" content="æœ€çŸ­è·¯">
<meta property="og:url" content="http://example.com/2021/05/04/%E6%9C%80%E7%9F%AD%E8%B7%AF/index.html">
<meta property="og:site_name" content="xudaxiaçš„åšå®¢">
<meta property="og:description" content="æœ€çŸ­è·¯æœ€çŸ­è·¯æ˜¯å›¾è®ºä¸­æœ€åŸºæœ¬çš„ä¸€ç±»é—®é¢˜ã€‚å¯ä»¥åˆ†ä¸ºå•æºæœ€çŸ­è·¯å’Œå¤šæºæœ€çŸ­è·¯ä¸¤ç±»ã€‚ å•æºæœ€çŸ­è·¯Dijkstraæœ€é«˜æ•ˆçš„æœ€çŸ­è·¯ç®—æ³•ï¼Œä½†æ˜¯ä¸èƒ½å¤„ç†æœ‰è´Ÿè¾¹æƒçš„å›¾ã€‚å…¶æœ¬è´¨æ˜¯ä¸æ–­è´ªå¿ƒã€‚ è€ƒè™‘ä»¥æŸä¸€ç‚¹uä¸ºèµ·ç‚¹çš„æœ€çŸ­è·¯ã€‚ æ£€æŸ¥ä»è¿™ä¸€ç‚¹çš„æ‰€æœ‰å‡ºè¾¹ï¼Œè®¾çŸ­çš„é‚£æ¡å‡ºè¾¹ä¸ºeã€‚æ˜¾ç„¶åˆ°eçš„ç»ˆç‚¹ï¼ˆè®¾ä¸ºvï¼‰çš„æœ€çŸ­è·¯å·²ç»ç¡®å®šï¼Œé•¿åº¦å°±æ˜¯eçš„é•¿åº¦wã€‚å› ä¸ºè‹¥æœ‰å…¶ä»–çš„æœ€çŸ­è·¯ï¼Œå…¶å¿…ç„¶åŒ…å«ä¸æ˜¯eçš„å…¶ä»–å‡ºè¾¹ï¼Œåˆå› ä¸ºå› ä¸ºeæ˜¯æœ€çŸ­çš„å‡ºè¾¹ï¼Œæ‰€ä»¥åŒ…å«éeè¾¹çš„è¿™">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://www.hualigs.cn/image/60900f7d7482b.jpg">
<meta property="og:image" content="https://www.hualigs.cn/image/609019631211f.jpg">
<meta property="article:published_time" content="2021-05-04T13:57:40.000Z">
<meta property="article:modified_time" content="2021-05-05T06:11:59.454Z">
<meta property="article:author" content="xudaxia">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://www.hualigs.cn/image/60900f7d7482b.jpg"><script src="/js/ui/mode.js"></script></head><body><script defer src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script defer src="/js/ui/fireworks.js"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="æ–‡ç« ç›®å½•"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-list-ordered"></use></svg></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="ç«™ç‚¹æ¦‚è§ˆ"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-passport-line"></use></svg></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info mickey-mouse"><a class="site-author-avatar" href="/about/" title="xudaxia"><img width="96" loading="lazy" src="/images/%E5%A4%B4%E5%83%8F.jpg" alt="xudaxia"><span class="site-author-status" title="æ°¸è¿œç›¸ä¿¡è‡ªå·±æ˜¯å…¨ä¸–ç•Œæœ€å¹¸ç¦çš„äºº">ğŸ’•</span></a><div class="site-author-name"><a href="/about/">xudaxia</a></div><a class="site-name" href="/about/site.html">xudaxiaçš„åšå®¢</a><sub class="site-subtitle"></sub><div class="site-desciption"></div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="é¦–é¡µ"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-home-4-line"></use></svg></span></a><div class="site-state-item"><a href="/archives/" title="å½’æ¡£"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-archive-line"></use></svg></span><span class="site-state-item-count">7</span></a></div><div class="site-state-item"><a href="/categories/" title="åˆ†ç±»"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-2-line"></use></svg></span><span class="site-state-item-count">0</span></a></div><div class="site-state-item"><a href="/tags/" title="æ ‡ç­¾"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="site-state-item-count">0</span></a></div><a class="site-state-item hty-icon-button" href="/about/" title="ç•™è¨€æ¿"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-clipboard-line"></use></svg></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" title="QQ 1522621554" target="_blank" style="color:#12B7F5"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-qq-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://github.com/Xu-DaXia-C" title="GitHub" target="_blank" style="color:#6e5494"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-github-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://music.163.com/#/user/home?id=1323118620" title="ç½‘æ˜“äº‘éŸ³ä¹" target="_blank" style="color:#C20C0C"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-netease-cloud-music-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://www.zhihu.com/people/xudaxia-74" title="çŸ¥ä¹" target="_blank" style="color:#0084FF"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-zhihu-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://space.bilibili.com/354494576" title="å“”å“©å“”å“©" target="_blank" style="color:#FF8EB3"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-bilibili-line"></use></svg></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/links/" title="æˆ‘çš„å°ä¼™ä¼´ä»¬" style="color:dodgerblue"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-genderless-line"></use></svg></a><a class="links-item hty-icon-button" href="/girls/" title="å–œæ¬¢çš„å¥³å­©å­" style="color:hotpink"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-women-line"></use></svg></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-contrast-2-line"></use></svg></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%80%E7%9F%AD%E8%B7%AF"><span class="toc-number">1.</span> <span class="toc-text">æœ€çŸ­è·¯</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8D%95%E6%BA%90%E6%9C%80%E7%9F%AD%E8%B7%AF"><span class="toc-number">1.1.</span> <span class="toc-text">å•æºæœ€çŸ­è·¯</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Dijkstra"><span class="toc-number">1.1.1.</span> <span class="toc-text">Dijkstra</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Bellman-Ford"><span class="toc-number">1.1.2.</span> <span class="toc-text">Bellman-Ford</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#spfa"><span class="toc-number">1.1.3.</span> <span class="toc-text">spfa</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%9A%E6%BA%90%E6%9C%80%E7%9F%AD%E8%B7%AF"><span class="toc-number">1.2.</span> <span class="toc-text">å¤šæºæœ€çŸ­è·¯</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#n%E6%AC%A1%E5%8D%95%E6%BA%90%E6%9C%80%E7%9F%AD%E8%B7%AF"><span class="toc-number">1.2.1.</span> <span class="toc-text">næ¬¡å•æºæœ€çŸ­è·¯</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Floyd"><span class="toc-number">1.2.2.</span> <span class="toc-text">Floyd</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Johnson"><span class="toc-number">1.2.3.</span> <span class="toc-text">Johnson</span></a></li></ol></li></ol></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="post-block" itemscope itemtype="https://schema.org/Article"><link itemprop="mainEntityOfPage" href="http://example.com/2021/05/04/%E6%9C%80%E7%9F%AD%E8%B7%AF/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="xudaxia"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="xudaxiaçš„åšå®¢"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">æœ€çŸ­è·¯</h1><div class="post-meta"><div class="post-time" style="display:inline-block"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-line"></use></svg></span> <span class="post-meta-icon-text">å‘è¡¨äº</span> <time title="åˆ›å»ºæ—¶é—´ï¼š2021-05-04 21:57:40" itemprop="dateCreated datePublished" datetime="2021-05-04T21:57:40+08:00">2021-05-04</time><span class="post-meta-divider">-</span><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-2-line"></use></svg></span> <span class="post-meta-icon-text">æ›´æ–°äº</span> <time title="ä¿®æ”¹æ—¶é—´ï¼š2021-05-05 14:11:59" itemprop="dateModified" datetime="2021-05-05T14:11:59+08:00">2021-05-05</time></div><div class="post-classify"></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body" style="--smc-primary:#0078E7;"><h3 id="æœ€çŸ­è·¯"><a href="#æœ€çŸ­è·¯" class="headerlink" title="æœ€çŸ­è·¯"></a>æœ€çŸ­è·¯</h3><p>æœ€çŸ­è·¯æ˜¯å›¾è®ºä¸­æœ€åŸºæœ¬çš„ä¸€ç±»é—®é¢˜ã€‚å¯ä»¥åˆ†ä¸ºå•æºæœ€çŸ­è·¯å’Œå¤šæºæœ€çŸ­è·¯ä¸¤ç±»ã€‚</p>
<h4 id="å•æºæœ€çŸ­è·¯"><a href="#å•æºæœ€çŸ­è·¯" class="headerlink" title="å•æºæœ€çŸ­è·¯"></a>å•æºæœ€çŸ­è·¯</h4><h5 id="Dijkstra"><a href="#Dijkstra" class="headerlink" title="Dijkstra"></a>Dijkstra</h5><p>æœ€é«˜æ•ˆçš„æœ€çŸ­è·¯ç®—æ³•ï¼Œä½†æ˜¯ä¸èƒ½å¤„ç†æœ‰è´Ÿè¾¹æƒçš„å›¾ã€‚<br>å…¶æœ¬è´¨æ˜¯ä¸æ–­è´ªå¿ƒã€‚</p>
<p>è€ƒè™‘ä»¥æŸä¸€ç‚¹uä¸ºèµ·ç‚¹çš„æœ€çŸ­è·¯ã€‚</p>
<p>æ£€æŸ¥ä»è¿™ä¸€ç‚¹çš„æ‰€æœ‰å‡ºè¾¹ï¼Œè®¾çŸ­çš„é‚£æ¡å‡ºè¾¹ä¸ºeã€‚æ˜¾ç„¶åˆ°eçš„ç»ˆ<strong>ç‚¹</strong>ï¼ˆè®¾ä¸ºvï¼‰çš„æœ€çŸ­è·¯å·²ç»ç¡®å®šï¼Œé•¿åº¦å°±æ˜¯eçš„é•¿åº¦wã€‚å› ä¸ºè‹¥æœ‰å…¶ä»–çš„æœ€çŸ­è·¯ï¼Œå…¶å¿…ç„¶åŒ…å«ä¸æ˜¯eçš„å…¶ä»–å‡ºè¾¹ï¼Œåˆå› ä¸ºå› ä¸ºeæ˜¯æœ€çŸ­çš„å‡ºè¾¹ï¼Œæ‰€ä»¥åŒ…å«éeè¾¹çš„è¿™æ¡è·¯å¾„é•¿åº¦å°±å·²ç»å¤§äºwäº†ã€‚</p>
<p>ç„¶åæ‰«ævçš„æ‰€æœ‰å‡ºè¾¹ï¼Œå†æ¬¡æ‰¾åˆ°ä»uå‡ºå‘åˆ°ä¸€ä¸ªæ²¡æœ‰ç¡®å®šæœ€çŸ­è·¯çš„ç‚¹ï¼ˆè®¾ä¸ºv1ï¼‰çš„æœ€çŸ­è·¯å¾„ã€‚é‚£ä¹ˆåŒä¸Šåˆ°v1çš„æœ€çŸ­è·¯å¾„é•¿åº¦ä¹Ÿè¢«ç¡®å®šäº†ã€‚</p>
<p>ç»§ç»­ä¸Šé¢çš„æ­¥éª¤ç›´åˆ°æ‰€æœ‰çš„ç‚¹çš„æœ€çŸ­è·¯ç¡®å®šã€‚</p>
<p>å…·ä½“å®ç°ä¸­ï¼Œå¯ä»¥åŠ å…¥ä¸€ä¸ªå †ï¼ˆä¼˜å…ˆé˜Ÿåˆ—ï¼‰æ¥ç»´æŠ¤æœ€çŸ­è·¯ç¨‹åˆ°è¾¾çš„ç‚¹ã€‚è¿™æ ·åšçš„è¯æ—¶é—´å¤æ‚åº¦ä¸ºO(nlogn)</p>
<p>å› ä¸ºè´Ÿè¾¹æƒä¼šå½±å“è´ªå¿ƒã€‚<br>æ‰€ä»¥è¿™ä¸ªç®—æ³•ä¸èƒ½è§£å†³è´Ÿè¾¹æƒæœ€çŸ­è·¯é—®é¢˜ã€‚</p>
<pre class="language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;cstdio></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;cmath></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;cstring></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;algorithm></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;queue></span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">N <span class="token number">100100</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">M <span class="token number">501000</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">INF <span class="token number">2147483647</span></span></span>
<span class="token keyword">struct</span> <span class="token class-name">edge</span><span class="token punctuation">&#123;</span>
	<span class="token keyword">int</span> v<span class="token punctuation">,</span>w<span class="token punctuation">,</span>nxt<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>e<span class="token punctuation">[</span>M<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">struct</span> <span class="token class-name">node</span><span class="token punctuation">&#123;</span>
	<span class="token keyword">int</span> x<span class="token punctuation">,</span>s<span class="token punctuation">;</span>
	<span class="token function">node</span><span class="token punctuation">(</span><span class="token keyword">int</span> X<span class="token punctuation">,</span><span class="token keyword">int</span> S<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
		x<span class="token operator">=</span>X<span class="token punctuation">,</span>s<span class="token operator">=</span>S<span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token comment">//ä¼˜å…ˆé˜Ÿåˆ—é»˜è®¤æ˜¯å¤§åœ¨å‰ã€‚ </span>
<span class="token keyword">bool</span> <span class="token keyword">operator</span> <span class="token operator">&lt;</span> <span class="token punctuation">(</span>node a<span class="token punctuation">,</span>node b<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
	<span class="token keyword">return</span> a<span class="token punctuation">.</span>s<span class="token operator">></span>b<span class="token punctuation">.</span>s<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">int</span> cnt<span class="token punctuation">,</span>head<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">add_edge</span><span class="token punctuation">(</span><span class="token keyword">int</span> u<span class="token punctuation">,</span><span class="token keyword">int</span> v<span class="token punctuation">,</span><span class="token keyword">int</span> w<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
	cnt<span class="token operator">++</span><span class="token punctuation">;</span>
	e<span class="token punctuation">[</span>cnt<span class="token punctuation">]</span><span class="token punctuation">.</span>nxt<span class="token operator">=</span>head<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">;</span>
	e<span class="token punctuation">[</span>cnt<span class="token punctuation">]</span><span class="token punctuation">.</span>v<span class="token operator">=</span>v<span class="token punctuation">;</span>
	e<span class="token punctuation">[</span>cnt<span class="token punctuation">]</span><span class="token punctuation">.</span>w<span class="token operator">=</span>w<span class="token punctuation">;</span>
	head<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token operator">=</span>cnt<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">int</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
	<span class="token keyword">int</span> f<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">int</span> sum<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">char</span> ch<span class="token operator">=</span><span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">while</span><span class="token punctuation">(</span>ch<span class="token operator">&lt;</span><span class="token string">'0'</span><span class="token operator">||</span>ch<span class="token operator">></span><span class="token string">'9'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
		f<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
		ch<span class="token operator">=</span><span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
	<span class="token keyword">while</span><span class="token punctuation">(</span>ch<span class="token operator">>=</span><span class="token string">'0'</span><span class="token operator">&amp;&amp;</span>ch<span class="token operator">&lt;=</span><span class="token string">'9'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
		sum<span class="token operator">=</span>sum<span class="token operator">*</span><span class="token number">10</span><span class="token operator">+</span>ch<span class="token operator">-</span><span class="token string">'0'</span><span class="token punctuation">;</span>
		ch<span class="token operator">=</span><span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
	<span class="token keyword">return</span> sum<span class="token operator">*</span>f<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">int</span> dis<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">,</span>n<span class="token punctuation">,</span>s<span class="token punctuation">;</span>
<span class="token keyword">bool</span> book<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">dijkstra</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>dis<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>INF<span class="token punctuation">;</span>
	priority_queue<span class="token operator">&lt;</span>node<span class="token operator">></span> q<span class="token punctuation">;</span>
	<span class="token function">memset</span><span class="token punctuation">(</span>book<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>book<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	dis<span class="token punctuation">[</span>s<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
	q<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token function">node</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">!</span>q<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
		<span class="token keyword">int</span> u<span class="token operator">=</span>q<span class="token punctuation">.</span><span class="token function">top</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>x<span class="token punctuation">;</span>
		q<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>book<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token keyword">continue</span><span class="token punctuation">;</span>
		book<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
		<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span>head<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">;</span>i<span class="token punctuation">;</span>i<span class="token operator">=</span>e<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>nxt<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
			<span class="token keyword">int</span> v<span class="token operator">=</span>e<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>v<span class="token punctuation">,</span>w<span class="token operator">=</span>e<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>w<span class="token punctuation">;</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>dis<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token operator">&lt;=</span>dis<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token operator">+</span>w<span class="token punctuation">)</span><span class="token keyword">continue</span><span class="token punctuation">;</span>
			dis<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token operator">=</span>dis<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token operator">+</span>w<span class="token punctuation">;</span>
			q<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token function">node</span><span class="token punctuation">(</span>v<span class="token punctuation">,</span>dis<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">int</span> m<span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
	n<span class="token operator">=</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>m<span class="token operator">=</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>s<span class="token operator">=</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>m<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
		<span class="token keyword">int</span> u<span class="token operator">=</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>v<span class="token operator">=</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>w<span class="token operator">=</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">adddij_edge</span><span class="token punctuation">(</span>u<span class="token punctuation">,</span>v<span class="token punctuation">,</span>w<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
	<span class="token function">dijkstra</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d "</span><span class="token punctuation">,</span>dis<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span> </code></pre>
<h5 id="Bellman-Ford"><a href="#Bellman-Ford" class="headerlink" title="Bellman-Ford"></a>Bellman-Ford</h5><p>æ­¤ç®—æ³•åŸºäºä¸€ä¸ªåŸºæœ¬æ“ä½œâ€”â€”æ¾å¼›æ“ä½œ</p>
<p>å³ if(dis[v]&gt;dis[u]+w)dis[v]=dis[u]+wï¼ˆdis[u]ä»£è¡¨ç›®å‰åˆ°uç‚¹æœ€çŸ­è·¯çš„æœ€ä¼˜è§£ï¼Œwæ˜¯è¾¹çš„æƒï¼‰</p>
<p>æ˜¾ç„¶å¦‚æœå¯¹æ•´ä¸ªè¾¹é›†åšä¸€æ¬¡æ¾å¼›æ“ä½œå°±ä¼šä½¿ç­”æ¡ˆæ›´ä¼˜ï¼Œå½“ç­”æ¡ˆä¸èƒ½æ›´ä¼˜çš„æ—¶å€™ï¼Œdiså³ä¸ºæœ€çŸ­è·¯ã€‚</p>
<p>è€ƒè™‘æ—¶é—´å¤æ‚åº¦</p>
<p>è€ƒè™‘æ¯æ¬¡æ¾å¼›æ“ä½œä¹‹åä¼šæœ‰å‡ ä¸ªç‚¹çš„æœ€çŸ­è·¯æˆä¸ºæœ€ä¼˜è§£ï¼Ÿ</p>
<p>é€šè¿‡è®²è§£Dijkstraå¯ä»¥çŸ¥é“ï¼Œä»ä¸€ä¸ªç‚¹é›†æ¾å¼›ä¸€æ¬¡è‡³å°‘å¯ä»¥å¾—åˆ°ä¸€ä¸ªç‚¹çš„æœ€çŸ­è·¯çš„æœ€ä¼˜è§£ã€‚</p>
<p>é‚£ä¹ˆæœ€å·®çš„æƒ…å†µå‘¢ï¼Ÿ</p>
<p><img src="https://www.hualigs.cn/image/60900f7d7482b.jpg" alt="" loading="lazy"></p>
<p>å¦‚å›¾ï¼ŒæŒ‰å›¾ä¸­è¾¹çš„é¡ºåºæ¾å¼›ï¼Œè¦æ¾å¼›5æ¬¡æ‰èƒ½è·å¾—æ‰€æœ‰æœ€çŸ­è·¯ã€‚</p>
<p>æ‰€ä»¥ä¸åŠ è¯æ˜åœ°å¾—å‡ºï¼šä»ä¸€ä¸ªç‚¹é›†æ¾å¼›ä¸€æ¬¡æœ€å·®åªèƒ½å¾—åˆ°ä¸€ä¸ªç‚¹çš„æœ€çŸ­è·¯çš„æœ€ä¼˜è§£ã€‚<br><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/b876fe9b2338">ä¸¥æ ¼è¯æ˜ä¼ é€é—¨</a></p>
<p>æ‰€ä»¥å¤æ‚åº¦ä¸ºO(mn)</p>
<h5 id="spfa"><a href="#spfa" class="headerlink" title="spfa"></a>spfa</h5><p>æ­¤ä¸ºä»¥ä¸Šç®—æ³•ä¼˜åŒ–ï¼Œå› ä¸ºåªæœ‰æ¾å¼›æˆåŠŸåœ°væ‰æœ‰æ„ä¹‰ï¼Œæ‰€ä»¥ç”¨ä¸€ä¸ªé˜Ÿåˆ—è£…è¿›æ‰€æœ‰æœ‰æ„ä¹‰çš„vç‚¹ï¼Œä»¥æ­¤å–å‡ºé˜Ÿåˆ—ä¸­çš„ç‚¹å¯¹å…¶æ‰€æœ‰è¾¹æ¾å¼›å³å¯ã€‚</p>
<p>å¯¹äºBellman-Fordä¸­çš„æœ€å·®æƒ…å†µæœ‰è¾ƒå¥½çš„æ•ˆç‡ã€‚</p>
<p>spfaå¯ä»¥å¤„ç†è´Ÿè¾¹æƒï¼ˆå…¶æœ¬è´¨å°±æ˜¯ä¼˜ç¾çš„æš´åŠ›ï¼‰ï¼Œå¯ä»¥æŸ¥è´Ÿç¯ã€‚ä¸€åº¦è¢«äººä»¬ï¼ˆåŒ…æ‹¬æˆ‘ï¼‰è®¤ä¸ºæ˜¯æœ€å¥½çš„çš„æœ€çŸ­è·¯ç®—æ³•ã€‚</p>
<p>ç„¶è€Œäººä»¬ï¼ˆåŒ…æ‹¬æˆ‘ï¼‰ä½¿ç”¨å®ƒæ—¶éƒ½é—å¿˜äº†å¯¹å…¶å¤æ‚åº¦çš„ç²¾ç¡®è¯æ˜ï¼ˆå°±è·Ÿä½¿ç”¨dinicæ—¶ä¸€æ ·ï¼‰ã€‚è¿™æ˜¯ä¸€ä¸ªéšæ‚£ï¼Œä½†æ˜¯äººä»¬å¹¶ä¸åœ¨æ„ã€‚ç»ˆäºæœ‰ä¸€å¤©NOI2018å½’ç¨‹å‡ºé¢˜äººç²¾å¿ƒè®¾è®¡çš„æ•°æ®æŠŠæ— æ•°äººå¡äº†ï¼ˆåŒ…æ‹¬æˆ‘å­¦é•¿ï¼‰ã€‚äººä»¬æ‰ç»™å®ƒåˆ¤äº†æ­»åˆ‘ã€‚</p>
<p>ä¸ºä»€ä¹ˆè¿™ä¹ˆå¤šäººå–œæ¬¢spfaï¼Ÿå› ä¸ºspfaåœ¨è·‘éšæœºå›¾æ—¶ç¡®å®éå¸¸ç»™åŠ›ã€‚<br><del>ä¸»è¦åŸå› è¿˜æ˜¯spfaå¥½å†™(ç¬‘)</del></p>
<pre class="language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;cstring></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;cmath></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;cstdio></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;algorithm></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;queue></span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">N <span class="token number">10010</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">M <span class="token number">500010</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">INF <span class="token number">2147483647</span></span></span>
<span class="token keyword">struct</span> <span class="token class-name">edge</span><span class="token punctuation">&#123;</span>
	<span class="token keyword">int</span> nxt<span class="token punctuation">,</span>v<span class="token punctuation">,</span>w<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>e<span class="token punctuation">[</span>M<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> cnt<span class="token punctuation">,</span>head<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">add_edge</span><span class="token punctuation">(</span><span class="token keyword">int</span> u<span class="token punctuation">,</span><span class="token keyword">int</span> v<span class="token punctuation">,</span><span class="token keyword">int</span> w<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
	cnt<span class="token operator">++</span><span class="token punctuation">;</span>
	e<span class="token punctuation">[</span>cnt<span class="token punctuation">]</span><span class="token punctuation">.</span>v<span class="token operator">=</span>v<span class="token punctuation">;</span>
	e<span class="token punctuation">[</span>cnt<span class="token punctuation">]</span><span class="token punctuation">.</span>w<span class="token operator">=</span>w<span class="token punctuation">;</span>
	e<span class="token punctuation">[</span>cnt<span class="token punctuation">]</span><span class="token punctuation">.</span>nxt<span class="token operator">=</span>head<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">;</span>
	head<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token operator">=</span>cnt<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">int</span> dis<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">,</span>num<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">,</span>n<span class="token punctuation">,</span>s<span class="token punctuation">;</span>
<span class="token keyword">bool</span> vis<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">spfa</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>dis<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>INF<span class="token punctuation">;</span>
	queue<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> q<span class="token punctuation">;</span>
	<span class="token function">memset</span><span class="token punctuation">(</span>vis<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>vis<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	vis<span class="token punctuation">[</span>s<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
	q<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
	dis<span class="token punctuation">[</span>s<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
	num<span class="token punctuation">[</span>s<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">!</span>q<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
		<span class="token keyword">int</span> u<span class="token operator">=</span>q<span class="token punctuation">.</span><span class="token function">front</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		q<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		vis<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
		<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span>head<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">;</span>i<span class="token punctuation">;</span>i<span class="token operator">=</span>e<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>nxt<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
			<span class="token keyword">int</span> v<span class="token operator">=</span>e<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>v<span class="token punctuation">,</span>w<span class="token operator">=</span>e<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>w<span class="token punctuation">;</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>dis<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token operator">&lt;=</span>dis<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token operator">+</span>w<span class="token punctuation">)</span><span class="token keyword">continue</span><span class="token punctuation">;</span>
			dis<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token operator">=</span>dis<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token operator">+</span>w<span class="token punctuation">;</span>
			num<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token operator">=</span>num<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>vis<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
				q<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>
				vis<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> 
			<span class="token punctuation">&#125;</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>num<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token operator">></span>n<span class="token punctuation">)</span><span class="token keyword">return</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">int</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
	<span class="token keyword">int</span> f<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">int</span> sum<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">char</span> ch<span class="token operator">=</span><span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">while</span><span class="token punctuation">(</span>ch<span class="token operator">&lt;</span><span class="token string">'0'</span><span class="token operator">||</span>ch<span class="token operator">></span><span class="token string">'9'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
		f<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
		ch<span class="token operator">=</span><span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
	<span class="token keyword">while</span><span class="token punctuation">(</span>ch<span class="token operator">>=</span><span class="token string">'0'</span><span class="token operator">&amp;&amp;</span>ch<span class="token operator">&lt;=</span><span class="token string">'9'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
		sum<span class="token operator">=</span>sum<span class="token operator">*</span><span class="token number">10</span><span class="token operator">+</span>ch<span class="token operator">-</span><span class="token string">'0'</span><span class="token punctuation">;</span>
		ch<span class="token operator">=</span><span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
	<span class="token keyword">return</span> sum<span class="token operator">*</span>f<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">int</span> m<span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
	<span class="token function">freopen</span><span class="token punctuation">(</span><span class="token string">"makedate.in"</span><span class="token punctuation">,</span><span class="token string">"r"</span><span class="token punctuation">,</span><span class="token constant">stdin</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">freopen</span><span class="token punctuation">(</span><span class="token string">"Dijkstra.out"</span><span class="token punctuation">,</span><span class="token string">"w"</span><span class="token punctuation">,</span><span class="token constant">stdout</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	n<span class="token operator">=</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>m<span class="token operator">=</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>s<span class="token operator">=</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>m<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
		<span class="token keyword">int</span> u<span class="token operator">=</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>v<span class="token operator">=</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>w<span class="token operator">=</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">add_edge</span><span class="token punctuation">(</span>u<span class="token punctuation">,</span>v<span class="token punctuation">,</span>w<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
	<span class="token function">spfa</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d "</span><span class="token punctuation">,</span>dis<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span> </code></pre>
<h4 id="å¤šæºæœ€çŸ­è·¯"><a href="#å¤šæºæœ€çŸ­è·¯" class="headerlink" title="å¤šæºæœ€çŸ­è·¯"></a>å¤šæºæœ€çŸ­è·¯</h4><h5 id="næ¬¡å•æºæœ€çŸ­è·¯"><a href="#næ¬¡å•æºæœ€çŸ­è·¯" class="headerlink" title="næ¬¡å•æºæœ€çŸ­è·¯"></a>næ¬¡å•æºæœ€çŸ­è·¯</h5><p>ä¸å¤šè¯´äº†ã€‚</p>
<h5 id="Floyd"><a href="#Floyd" class="headerlink" title="Floyd"></a>Floyd</h5><p>$O(n^3)$çš„ç®—æ³•ï¼Œå¤§å¤šæ•°æ—¶å€™ä¼˜äº$n$æ¬¡$dijkstra$ã€‚butå®ƒä¸èƒ½å¤„ç†è´Ÿç¯ã€‚</p>
<p>æšä¸¾ä¸€ä¸ªä¸­é—´ç‚¹$k$ï¼Œç„¶åæšä¸¾ç‚¹å¯¹$(i,j)$ã€‚å°è¯•ç”¨$dis[i,k]+dis[j,k]$æ¾å¼›$dis[i,j]$ã€‚</p>
<p>ä¸ºä»€ä¹ˆè¿™æ ·æ—¶å¯è¡Œçš„ï¼Ÿæ›´æ¢æšä¸¾é¡ºåºè¡Œä¸è¡Œï¼ˆå…ˆæšä¸¾ç‚¹å¯¹å†æšä¸¾ä¸­é—´ç‚¹ï¼‰ï¼Ÿ</p>
<p>è€ƒè™‘ä»»æ„ä¸€æ¡æœ€çŸ­è·¯ã€‚æœ€çŸ­è·¯ä¸Šçš„æ‰€æœ‰ç‚¹éƒ½ä¼šä½œä¸ºkè¢«æšä¸¾ï¼Œç„¶åè”é€šç›¸é‚»ç‚¹é›†çš„æœ€çŸ­è·¯ã€‚æœ€åè¿™æ¡è·¯æ•´ä¸ªä¼šè¢«è”é€šã€‚</p>
<p><img src="https://www.hualigs.cn/image/609019631211f.jpg" alt="" loading="lazy"></p>
<p>å¦‚å›¾ï¼Œæ–¹å—ä¸­æ˜¯å·²ç»ç¡®å®šå½¼æ­¤æœ€çŸ­è·¯çš„ç‚¹é›†ï¼ˆå› ä¸ºæœ€çŸ­è·¯æ€»æ˜¯æœ‰ä¸€ä¸ªä¸ªæœ€çŸ­è·¯ç»„æˆï¼Œæ‰€ä»¥ä¸€æ¡æœ€çŸ­è·¯ä¸Šç‚¹å½¼æ­¤ä¹‹é—´çš„æœ€çŸ­è·¯æ˜¯æ•´ä¸ªæœ€çŸ­è·¯çš„ä¸€éƒ¨åˆ†ï¼‰ï¼Œæšä¸¾kä¸ºä¸­é—´ç‚¹ä¹‹åï¼Œiä¼šåŒ…å«è¿›æ¥ï¼Œæ˜¾ç„¶æœ€åæ‰€æœ‰ç‚¹éƒ½ä¼šåŒ…å«è¿›æ¥ã€‚</p>
<p>å…ˆæšä¸¾ç‚¹å¯¹å†æšä¸¾ä¸­é—´ç‚¹æ¯«æ— é“ç†ï¼Œæ‰€ä»¥ä¼šå‡ºé—®é¢˜ã€‚</p>
<p>ä»£ç å¤ªç®€å•å°±ä¸å†™äº†ã€‚</p>
<h5 id="Johnson"><a href="#Johnson" class="headerlink" title="Johnson"></a>Johnson</h5><p>æœ‰çš„æ—¶å€™næ¬¡dijkstraæ¯”Floydæ›´åŠ é«˜æ•ˆï¼ˆæ¯”å¦‚æ¯”è¾ƒç¨€ç–çš„å›¾ï¼‰ï¼Œä½†æ˜¯è‹¦äºèƒ½è§£è´Ÿè¾¹æƒçš„é—®é¢˜ã€‚å…¶å®dijkstraæ˜¯å¯ä»¥å¤„ç†å¸¦è´Ÿè¾¹æƒçš„å›¾çš„ï¼Œåªæ˜¯éœ€è¦ä¸€äº›æŠ€å·§ã€‚</p>
<p>ï¼ˆæ˜¯çš„ï¼Œjohnsonç®—æ³•æå‡ºæ—¶æ˜¯ä¸ºäº†è§£å†³ç¨€ç–å›¾ä¸­çš„å¤šæºæœ€çŸ­è·¯é—®é¢˜ï¼Œä½†æ˜¯å®ƒæœ€é‡è¦çš„æ€æƒ³æ˜¯æå‡ºäº†è§£å†³dijkstraä¸èƒ½è§£å†³è´Ÿè¾¹æƒé—®é¢˜çš„è§£å†³æ–¹æ³•ï¼‰</p>
<p>ä¸€ä¸ªæ¯”è¾ƒè‡ªç„¶çš„æƒ³æ³•æ˜¯æŠŠæ‰€æœ‰è¾¹æƒåŠ ä¸Šä¸€ä¸ªxä½¿å…¶å…¨éƒ¨å¤§äº0ã€‚ä½†æ˜¯è¿™æ˜¾ç„¶é”™è¯¯:<br>é¦–å…ˆæ˜¯å› ä¸ºæœ‰è´Ÿç¯çš„å­˜åœ¨ã€‚è¿™ç§æƒ…å†µä¸‹æœ‰çš„ç‚¹å¯¹ä¹‹é—´æ ¹æœ¬æ²¡æœ‰æœ€çŸ­è·¯ã€‚<br>å…¶æ¬¡åœ¨æ¯ä¸€ä¸ªè¾¹ä¸ŠåŠ ä¸€ä¸ªæ•°ä¼šä½¿æ¯”è¾ƒçŸ­ï¼ˆè¿™é‡ŒæŒ‡åŒ…å«è¾¹æ•°è¾ƒå°‘ï¼‰çš„è·¯æ›´ä¼˜ã€‚</p>
<p>æ­£ç¡®çš„æ€è·¯æ˜¯æ–°å»ºä¸€ä¸ªèŠ‚ç‚¹sï¼Œç”¨è¾¹æƒä¸º0çš„æœ‰å‘è¾¹è¿æ¥så’Œå…¶ä»–ç‚¹ã€‚ç„¶åä»¥sä¸ºèµ·ç‚¹è·‘ä¸€ä¸ªBellman-Fordæˆ–è€…spfaï¼ˆå¯ä»¥å¤„ç†è´Ÿè¾¹æƒæˆ–è´Ÿç¯çš„ç®—æ³•ï¼‰ï¼ˆè¿™ä¹Ÿæ˜¯johnsonä¸ºä»€ä¹ˆæ˜¯å¤šæºæœ€çŸ­è·¯ç®—æ³•çš„åŸå› ã€‚å¦‚æœæ˜¯å•æºæœ€çŸ­è·¯ï¼Œæ—¢ç„¶è¦è·‘ä¸€è¾¹spfaå†è·‘dijkstraï¼Œä¸ºä»€ä¹ˆä¸ç›´æ¥è·‘spfaï¼‰ï¼Œå¾—åˆ°ä»såˆ°æ¯ä¸€ä¸ªç‚¹çš„æœ€çŸ­è·¯ï¼Œè®°ä¸ºf[i]ã€‚ç„¶åæŠŠåŸå›¾ä¸­æ‰€æœ‰è¾¹æƒæ¢æˆwâ€™=w+f[u]-f[v]ã€‚ç„¶åè·‘dijkstraå°±æ˜¯æ­£ç¡®çš„ã€‚</p>
<p>è€ƒè™‘å…¶æ­£ç¡®æ€§ã€‚ä¸»è¦ä»ä¸¤ä¸ªæ–¹é¢è€ƒè™‘ï¼š1ã€åœ¨æ–°å›¾ä¸­è·‘å‡ºæ¥çš„æœ€çŸ­è·¯æ˜¯å¦æ˜¯åŸå›¾çš„æœ€çŸ­è·¯ã€‚2ã€æ–°å›¾ä¸­æ‰€æœ‰è¾¹çš„è¾¹æƒæ˜¯å¦éè´Ÿã€‚</p>
<p>ç¬¬äºŒç‚¹æ¯”è¾ƒå¥½è¯æ˜ï¼šåœ¨è·‘ç¬¬ä¸€æ¬¡spfaä¹‹åå¿…ç„¶æœ‰ä¸ç­‰å¼f[v]&lt;=f[u]+wã€‚wâ€™=w+f[u]-f[v]&gt;=0ã€‚</p>
<p>ç„¶åæ˜¯ç¬¬ä¸€ç‚¹ï¼šä½¿ç”¨åŠ¿èƒ½è¯æ˜(ä¼¼ä¹splayä¹Ÿæ˜¯ç”¨åŠ¿èƒ½è¯æ˜çš„)ã€‚åŠ¿èƒ½çš„ç‰¹ç‚¹æ˜¯ï¼Œä¸¤ä¸ªç‚¹åŠ¿èƒ½ä¹‹å·®ä¸€å®šæ˜¯ä¸€ä¸ªå¸¸æ•°ï¼Œè·Ÿé›¶åŠ¿èƒ½å¤„çš„ä½ç½®æ— å…³ã€‚ç„¶åè€ƒè™‘æ–°å›¾ä¸­ä¸€æ¡è·¯çš„é•¿åº¦ï¼šw1â€™+w2â€™+w3â€™+Â·Â·Â·+wmâ€™=(w1+f[s]-f[p2])+(w2+f[p2]-f[p3])+(w3+f[p3]-f[p4])+Â·Â·Â·+(wn+f[pn]-f[t])=w1+w2+w3+Â·Â·Â·+wn+f[s]-f[t]ï¼ˆpnä»£è¡¨è¿™æ¡æœ‰å‘é“è·¯çš„ç¬¬nä¸ªç‚¹ï¼Œsæ˜¯èµ·ç‚¹ï¼Œtæ˜¯ç»ˆç‚¹ï¼‰ã€‚å¯ä»¥å‘ç°æ–°å›¾ä¸­ä»såˆ°tçš„ä»»æ„é“è·¯é•¿åº¦ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼Œä¸€ä¸ªæ˜¯åŸå§‹é“è·¯é•¿åº¦ï¼Œå¦ä¸€ä¸ªæ˜¯ä¸€ä¸ªåªå’Œsï¼Œtæœ‰å…³çš„é‡ï¼ˆå°±åƒåŠ¿èƒ½ä¸€æ ·ï¼‰ã€‚å…¶è·¯å¾„çš„é•¿çŸ­åªå’ŒåŸå§‹é“è·¯é•¿çŸ­æœ‰å…³ã€‚æ•…æ–°å›¾ä¸­çš„æœ€çŸ­è·¯å°±æ˜¯åŸå›¾ä¸­çš„æœ€çŸ­è·¯ã€‚</p>
<pre class="language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;cstring></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;cstdio></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;cmath></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;algorithm></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;queue></span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">N <span class="token number">3010</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">M N<span class="token operator">+</span><span class="token number">6010</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">INF <span class="token number">1e9</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression"><span class="token keyword">int</span> <span class="token keyword">long</span> <span class="token keyword">long</span></span></span>
<span class="token keyword">struct</span> <span class="token class-name">edge</span><span class="token punctuation">&#123;</span>
	<span class="token keyword">int</span> nxt<span class="token punctuation">,</span>v<span class="token punctuation">,</span>w<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>e<span class="token punctuation">[</span>M<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> cnt<span class="token punctuation">,</span>head<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">add_edge</span><span class="token punctuation">(</span><span class="token keyword">int</span> u<span class="token punctuation">,</span><span class="token keyword">int</span> v<span class="token punctuation">,</span><span class="token keyword">int</span> w<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
	cnt<span class="token operator">++</span><span class="token punctuation">;</span>
	e<span class="token punctuation">[</span>cnt<span class="token punctuation">]</span><span class="token punctuation">.</span>nxt<span class="token operator">=</span>head<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">;</span>
	e<span class="token punctuation">[</span>cnt<span class="token punctuation">]</span><span class="token punctuation">.</span>v<span class="token operator">=</span>v<span class="token punctuation">;</span>
	e<span class="token punctuation">[</span>cnt<span class="token punctuation">]</span><span class="token punctuation">.</span>w<span class="token operator">=</span>w<span class="token punctuation">;</span>
	head<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token operator">=</span>cnt<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">int</span> f<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">,</span>num<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">,</span>n<span class="token punctuation">,</span>s<span class="token punctuation">;</span>
<span class="token keyword">bool</span> vis<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">spfa</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>f<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>INF<span class="token punctuation">;</span>
	<span class="token function">memset</span><span class="token punctuation">(</span>vis<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>vis<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	queue<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> q<span class="token punctuation">;</span>
	q<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
	vis<span class="token punctuation">[</span>s<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
	f<span class="token punctuation">[</span>s<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
	num<span class="token punctuation">[</span>s<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">!</span>q<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
		<span class="token keyword">int</span> u<span class="token operator">=</span>q<span class="token punctuation">.</span><span class="token function">front</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>q<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		vis<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
		<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span>head<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">;</span>i<span class="token punctuation">;</span>i<span class="token operator">=</span>e<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>nxt<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
			<span class="token keyword">int</span> v<span class="token operator">=</span>e<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>v<span class="token punctuation">,</span>w<span class="token operator">=</span>e<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>w<span class="token punctuation">;</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>f<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token operator">&lt;=</span>f<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token operator">+</span>w<span class="token punctuation">)</span><span class="token keyword">continue</span><span class="token punctuation">;</span>
			f<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token operator">=</span>f<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token operator">+</span>w<span class="token punctuation">;</span>
			num<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token operator">=</span>num<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>num<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token operator">></span>n<span class="token punctuation">)</span><span class="token keyword">return</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>vis<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">continue</span><span class="token punctuation">;</span>
			q<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>
			vis<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">struct</span> <span class="token class-name">node</span><span class="token punctuation">&#123;</span>
	<span class="token keyword">int</span> x<span class="token punctuation">,</span>s<span class="token punctuation">;</span>
	<span class="token function">node</span><span class="token punctuation">(</span><span class="token keyword">int</span> X<span class="token punctuation">,</span><span class="token keyword">int</span> S<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
		x<span class="token operator">=</span>X<span class="token punctuation">,</span>s<span class="token operator">=</span>S<span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token keyword">bool</span> <span class="token keyword">operator</span> <span class="token operator">&lt;</span><span class="token punctuation">(</span>node a<span class="token punctuation">,</span>node b<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
	<span class="token keyword">return</span> a<span class="token punctuation">.</span>s<span class="token operator">></span>b<span class="token punctuation">.</span>s<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span> 
<span class="token keyword">int</span> dis<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">dijkstra</span><span class="token punctuation">(</span><span class="token keyword">int</span> s<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>dis<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>INF<span class="token punctuation">;</span>
	<span class="token function">memset</span><span class="token punctuation">(</span>vis<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>vis<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	dis<span class="token punctuation">[</span>s<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
	priority_queue<span class="token operator">&lt;</span>node<span class="token operator">></span> q<span class="token punctuation">;</span>
	q<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token function">node</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">!</span>q<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
		<span class="token keyword">int</span> u<span class="token operator">=</span>q<span class="token punctuation">.</span><span class="token function">top</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>x<span class="token punctuation">;</span>
		q<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>vis<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">continue</span><span class="token punctuation">;</span>
		vis<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
		<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span>head<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">;</span>i<span class="token punctuation">;</span>i<span class="token operator">=</span>e<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>nxt<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
			<span class="token keyword">int</span> v<span class="token operator">=</span>e<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>v<span class="token punctuation">,</span>w<span class="token operator">=</span>e<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>w<span class="token punctuation">;</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>dis<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token operator">&lt;=</span>dis<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token operator">+</span>w<span class="token punctuation">)</span><span class="token keyword">continue</span><span class="token punctuation">;</span>
			dis<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token operator">=</span>dis<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token operator">+</span>w<span class="token punctuation">;</span>
			q<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token function">node</span><span class="token punctuation">(</span>v<span class="token punctuation">,</span>dis<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
		<span class="token punctuation">&#125;</span>
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">int</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
	<span class="token keyword">int</span> sum<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>f<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token keyword">char</span> ch<span class="token operator">=</span><span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">while</span><span class="token punctuation">(</span>ch<span class="token operator">&lt;</span><span class="token string">'0'</span><span class="token operator">||</span>ch<span class="token operator">></span><span class="token string">'9'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>f<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>ch<span class="token operator">=</span><span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>
	<span class="token keyword">while</span><span class="token punctuation">(</span>ch<span class="token operator">&lt;=</span><span class="token string">'9'</span><span class="token operator">&amp;&amp;</span>ch<span class="token operator">>=</span><span class="token string">'0'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>sum<span class="token operator">=</span>sum<span class="token operator">*</span><span class="token number">10</span><span class="token operator">+</span>ch<span class="token operator">-</span><span class="token string">'0'</span><span class="token punctuation">;</span>ch<span class="token operator">=</span><span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>
	<span class="token keyword">return</span> sum<span class="token operator">*</span>f<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">int</span> m<span class="token punctuation">;</span>
<span class="token keyword">signed</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
	n<span class="token operator">=</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>m<span class="token operator">=</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>m<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
		<span class="token keyword">int</span> u<span class="token operator">=</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>v<span class="token operator">=</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>w<span class="token operator">=</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">add_edge</span><span class="token punctuation">(</span>u<span class="token punctuation">,</span>v<span class="token punctuation">,</span>w<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
	s<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token function">add_edge</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span>i<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">spfa</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>num<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">></span>n<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
			<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"-1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
		<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j<span class="token operator">=</span>head<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>j<span class="token punctuation">;</span>j<span class="token operator">=</span>e<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>nxt<span class="token punctuation">)</span>e<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>w<span class="token operator">=</span>e<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>w<span class="token operator">+</span>f<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-</span>f<span class="token punctuation">[</span>e<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>v<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
		<span class="token function">dijkstra</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">int</span> ans<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
		<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>j<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span>ans<span class="token operator">+=</span>j<span class="token operator">*</span><span class="token function">min</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>INF<span class="token punctuation">,</span>dis<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">-</span>f<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%lld\n"</span><span class="token punctuation">,</span>ans<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span> </code></pre></div><div id="reward-container"><span class="hty-icon-button button-glow" id="reward-button" title="æ‰“èµ" onclick="var qr = document.getElementById(&quot;qr&quot;); qr.style.display = (qr.style.display === &quot;none&quot;) ? &quot;block&quot; : &quot;none&quot;;"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-hand-coin-line"></use></svg></span><div id="reward-comment">I'm so cute. Please give me money.</div><div id="qr" style="display:none;"><div style="display:inline-block"><a target="_blank" rel="noopener" href="https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/donate/alipay-qrcode.jpg"><img loading="lazy" src="https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/donate/alipay-qrcode.jpg" alt="æ”¯ä»˜å®" title="æ”¯ä»˜å®"></a><div><span style="color:#00A3EE"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-alipay-line"></use></svg></span></div></div><div style="display:inline-block"><a target="_blank" rel="noopener" href="https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/donate/qqpay-qrcode.png"><img loading="lazy" src="https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/donate/qqpay-qrcode.png" alt="QQ æ”¯ä»˜" title="QQ æ”¯ä»˜"></a><div><span style="color:#12B7F5"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-qq-line"></use></svg></span></div></div><div style="display:inline-block"><a target="_blank" rel="noopener" href="https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/donate/wechatpay-qrcode.jpg"><img loading="lazy" src="https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/donate/wechatpay-qrcode.jpg" alt="å¾®ä¿¡æ”¯ä»˜" title="å¾®ä¿¡æ”¯ä»˜"></a><div><span style="color:#2DC100"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-wechat-pay-line"></use></svg></span></div></div></div></div><ul class="post-copyright"><li class="post-copyright-author"><strong>æœ¬æ–‡ä½œè€…ï¼š</strong>xudaxia</li><li class="post-copyright-link"><strong>æœ¬æ–‡é“¾æ¥ï¼š</strong><a href="http://example.com/2021/05/04/%E6%9C%80%E7%9F%AD%E8%B7%AF/" title="æœ€çŸ­è·¯">http://example.com/2021/05/04/%E6%9C%80%E7%9F%AD%E8%B7%AF/</a></li><li class="post-copyright-license"><strong>ç‰ˆæƒå£°æ˜ï¼š</strong>æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é»˜è®¤é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><svg class="icon"><use xlink:href="#icon-creative-commons-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-by-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-nc-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-sa-line"></use></svg></a> è®¸å¯åè®®ã€‚</li></ul></section></article><div class="post-nav"><div class="post-nav-item"></div><div class="post-nav-item"><a class="post-nav-next" href="/2021/03/23/hello-world/" rel="next" title="Hello World"><span class="post-nav-text">Hello World</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-right-s-line"></use></svg></a></div></div></div><div id="comment"><div class="comment-tooltip text-center"><span>ç‚¹å‡»æŒ‰é’®è·³è½¬ GitHub Issues è¯„è®ºã€‚</span><br><span>è‹¥æ²¡æœ‰æœ¬æ–‡ Issueï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ Comment æ¨¡ç‰ˆæ–°å»ºã€‚</span><br><a class="hty-button hty-button--raised" id="github-issues" target="_blank" rel="noopener" href="https://github.com/YunYouJun/yunyoujun.github.io/issues?q=is:issue+æœ€çŸ­è·¯">GitHub Issues</a></div></div></main><footer class="sidebar-translate" id="footer"><div class="copyright"><span>&copy; 2019 â€“ 2021 </span><span class="with-love" id="animate"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-cloud-line"></use></svg></span><span class="author"> xudaxia</span></div><div class="powered"><span>ç”± <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> é©±åŠ¨ v5.2.0</span><span class="footer-separator">|</span><span>ä¸»é¢˜ - <a rel="noopener" href="https://github.com/YunYouJun/hexo-theme-yun" target="_blank"><span>Yun</span></a> v1.3.0</span></div></footer><a class="hty-icon-button" id="goUp" aria-label="back-to-top" href="#"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-up-s-line"></use></svg><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#0078E7" stroke-width="2" stroke-linecap="round"></circle></svg></a></div><script defer src="/js/utils.js"></script><script defer src="/js/hexo-theme-yun.js"></script></body></html>