<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#0078E7"><meta name="author" content="xudaxia"><meta name="copyright" content="xudaxia"><meta name="generator" content="Hexo 5.2.0"><meta name="theme" content="hexo-theme-yun"><title>AT89C52学习笔记 | xudaxia的博客</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/star-markdown-css@0.1.22/dist/yun/yun-markdown.min.css"><script src="//at.alicdn.com/t/font_1140697_ed8vp4atwoj.js" async></script><script src="https://cdn.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>document.addEventListener("DOMContentLoaded", () => {
  [".post-card",".post-content img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
});
</script><link id="light-prism-css" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.20.0/themes/prism.css" media="(prefers-color-scheme: light)"><link id="dark-prism-css" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.20.0/themes/prism-tomorrow.css" media="(prefers-color-scheme: dark)"><link rel="shortcut icon" type="image/svg+xml" href="/yun.svg"><link rel="mask-icon" href="/yun.svg" color="#0078E7"><link rel="alternate icon" href="/yun.ico"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="preload" href="/js/utils.js" as="script"><link rel="preload" href="/js/hexo-theme-yun.js" as="script"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script id="yun-config">
    const Yun = window.Yun || {};
    window.CONFIG = {"hostname":"example.com","root":"/","title":"Xu-DaXia-C","version":"1.3.0","mode":"auto","copycode":true,"anonymous_image":"https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/avatar/none.jpg","say":{"api":"/data/sentences.json"},"fireworks":{"colors":["102, 167, 221","62, 131, 225","33, 78, 194"]}};
  </script><meta name="description" content="单片机单片机全称叫单片微型计算机（Single Chip Microcomputer） 我玩的这款是AT89C52 它长这样： 当然，乍一看到这个板子并不能让人感到快乐，而是十分头大（我只能看到一堆电子器件，这是个什么东西？） 所以玩耍的前提是了解，接下来慢慢讲解单片机的一些基础知识和其一些简单功能的具体实现，而不纠结于其原理。 电平特征数字电路中只有两种电平：高电平和低电平高电平：5V或者3.3">
<meta property="og:type" content="article">
<meta property="og:title" content="AT89C52学习笔记">
<meta property="og:url" content="http://example.com/2021/01/21/AT89C52%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/index.html">
<meta property="og:site_name" content="xudaxia的博客">
<meta property="og:description" content="单片机单片机全称叫单片微型计算机（Single Chip Microcomputer） 我玩的这款是AT89C52 它长这样： 当然，乍一看到这个板子并不能让人感到快乐，而是十分头大（我只能看到一堆电子器件，这是个什么东西？） 所以玩耍的前提是了解，接下来慢慢讲解单片机的一些基础知识和其一些简单功能的具体实现，而不纠结于其原理。 电平特征数字电路中只有两种电平：高电平和低电平高电平：5V或者3.3">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://s3.ax1x.com/2021/01/21/s429c6.jpg">
<meta property="og:image" content="https://s3.ax1x.com/2021/01/21/s4R5Q0.png">
<meta property="og:image" content="https://s3.ax1x.com/2021/01/21/s4fy5Q.jpg">
<meta property="og:image" content="https://s3.ax1x.com/2021/01/21/s4htdU.png">
<meta property="og:image" content="https://s3.ax1x.com/2021/01/21/s45TIS.png">
<meta property="og:image" content="https://s3.ax1x.com/2021/01/21/s47z6J.png">
<meta property="og:image" content="https://s3.ax1x.com/2021/01/21/s4HYcQ.jpg">
<meta property="og:image" content="https://s3.ax1x.com/2021/01/21/s4qXff.png">
<meta property="og:image" content="https://s3.ax1x.com/2021/01/21/s4LOb9.png">
<meta property="og:image" content="https://s3.ax1x.com/2021/01/21/s4jec8.png">
<meta property="og:image" content="https://s3.ax1x.com/2021/01/21/s4jObQ.png">
<meta property="og:image" content="https://s3.ax1x.com/2021/01/21/s4ztjf.png">
<meta property="og:image" content="https://www.hualigs.cn/image/6052c59bcda83.jpg">
<meta property="og:image" content="https://s3.ax1x.com/2021/01/21/s591N4.png">
<meta property="og:image" content="https://s3.ax1x.com/2021/01/29/yPfHXQ.png">
<meta property="og:image" content="https://s3.ax1x.com/2021/01/29/yPLHw8.png">
<meta property="og:image" content="https://s3.ax1x.com/2021/01/29/yPjvSH.png">
<meta property="og:image" content="https://s3.ax1x.com/2021/01/29/yPzKiT.png">
<meta property="og:image" content="https://s3.ax1x.com/2021/01/29/yi94SO.png">
<meta property="og:image" content="https://s3.ax1x.com/2021/01/29/yiIok9.png">
<meta property="og:image" content="https://s3.ax1x.com/2021/02/07/ytw3Y6.jpg">
<meta property="og:image" content="https://s3.ax1x.com/2021/02/07/ytwNOH.jpg">
<meta property="og:image" content="https://s3.ax1x.com/2021/02/07/ytrp90.jpg">
<meta property="og:image" content="https://s3.ax1x.com/2021/02/07/ytyT91.png">
<meta property="og:image" content="https://www.hualigs.cn/image/606179084b807.jpg">
<meta property="og:image" content="https://www.hualigs.cn/image/60617a3e57797.jpg">
<meta property="og:image" content="https://www.hualigs.cn/image/60618e477b7ed.jpg">
<meta property="og:image" content="https://www.hualigs.cn/image/60618600129e9.jpg">
<meta property="og:image" content="https://www.hualigs.cn/image/606186e43d389.jpg">
<meta property="og:image" content="https://www.hualigs.cn/image/60618dd63af6d.jpg">
<meta property="og:image" content="https://www.hualigs.cn/image/60618db3e5f35.jpg">
<meta property="og:image" content="https://www.hualigs.cn/image/60619a594f2d6.jpg">
<meta property="og:image" content="https://www.hualigs.cn/image/60619c14a25e2.jpg">
<meta property="og:image" content="https://www.hualigs.cn/image/6061b836628ac.jpg">
<meta property="og:image" content="https://www.hualigs.cn/image/6061b93a69999.jpg">
<meta property="og:image" content="https://www.hualigs.cn/image/6061ba69b1d19.jpg">
<meta property="og:image" content="https://www.hualigs.cn/image/6061bb46b0a84.jpg">
<meta property="og:image" content="https://www.hualigs.cn/image/6061bc69ac866.jpg">
<meta property="og:image" content="https://www.hualigs.cn/image/6061be9c7b267.jpg">
<meta property="og:image" content="https://www.hualigs.cn/image/6061c09af2427.jpg">
<meta property="og:image" content="https://www.hualigs.cn/image/6061c0da1cece.jpg">
<meta property="og:image" content="https://www.hualigs.cn/image/6061c0ff9fb62.jpg">
<meta property="og:image" content="https://www.hualigs.cn/image/6061c3657f56a.jpg">
<meta property="og:image" content="https://www.hualigs.cn/image/6061c424255ea.jpg">
<meta property="og:image" content="https://www.hualigs.cn/image/6061c57d91c08.jpg">
<meta property="og:image" content="https://www.hualigs.cn/image/6063081b75da2.jpg">
<meta property="og:image" content="https://www.hualigs.cn/image/6063088d79e5f.jpg">
<meta property="og:image" content="https://www.hualigs.cn/image/60630a3051e2d.jpg">
<meta property="og:image" content="https://www.hualigs.cn/image/60630bbd029c9.jpg">
<meta property="og:image" content="https://www.hualigs.cn/image/60630cad658f8.jpg">
<meta property="og:image" content="https://www.hualigs.cn/image/606311566f04f.jpg">
<meta property="og:image" content="https://www.hualigs.cn/image/60631195379c9.jpg">
<meta property="og:image" content="https://www.hualigs.cn/image/60630f506504f.jpg">
<meta property="og:image" content="https://www.hualigs.cn/image/606310f2a6dbb.jpg">
<meta property="article:published_time" content="2021-01-21T15:53:24.000Z">
<meta property="article:modified_time" content="2021-03-30T14:27:56.658Z">
<meta property="article:author" content="xudaxia">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s3.ax1x.com/2021/01/21/s429c6.jpg"><script src="/js/ui/mode.js"></script></head><body><script defer src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script defer src="/js/ui/fireworks.js"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="文章目录"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-list-ordered"></use></svg></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="站点概览"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-passport-line"></use></svg></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info mickey-mouse"><a class="site-author-avatar" href="/about/" title="xudaxia"><img width="96" loading="lazy" src="/images/%E5%A4%B4%E5%83%8F.jpg" alt="xudaxia"><span class="site-author-status" title="永远相信自己是全世界最幸福的人">💕</span></a><div class="site-author-name"><a href="/about/">xudaxia</a></div><a class="site-name" href="/about/site.html">xudaxia的博客</a><sub class="site-subtitle"></sub><div class="site-desciption"></div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="首页"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-home-4-line"></use></svg></span></a><div class="site-state-item"><a href="/archives/" title="归档"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-archive-line"></use></svg></span><span class="site-state-item-count">7</span></a></div><div class="site-state-item"><a href="/categories/" title="分类"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-2-line"></use></svg></span><span class="site-state-item-count">0</span></a></div><div class="site-state-item"><a href="/tags/" title="标签"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="site-state-item-count">0</span></a></div><a class="site-state-item hty-icon-button" href="/about/" title="留言板"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-clipboard-line"></use></svg></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" title="QQ 1522621554" target="_blank" style="color:#12B7F5"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-qq-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://github.com/Xu-DaXia-C" title="GitHub" target="_blank" style="color:#6e5494"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-github-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://music.163.com/#/user/home?id=1323118620" title="网易云音乐" target="_blank" style="color:#C20C0C"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-netease-cloud-music-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://www.zhihu.com/people/xudaxia-74" title="知乎" target="_blank" style="color:#0084FF"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-zhihu-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://space.bilibili.com/354494576" title="哔哩哔哩" target="_blank" style="color:#FF8EB3"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-bilibili-line"></use></svg></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/links/" title="我的小伙伴们" style="color:dodgerblue"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-genderless-line"></use></svg></a><a class="links-item hty-icon-button" href="/girls/" title="喜欢的女孩子" style="color:hotpink"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-women-line"></use></svg></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-contrast-2-line"></use></svg></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%95%E7%89%87%E6%9C%BA"><span class="toc-number">1.</span> <span class="toc-text">单片机</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%B5%E5%B9%B3%E7%89%B9%E5%BE%81"><span class="toc-number">2.</span> <span class="toc-text">电平特征</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%95%E7%89%87%E6%9C%BA%E6%9C%80%E5%B0%8F%E7%B3%BB%E7%BB%9F"><span class="toc-number">3.</span> <span class="toc-text">单片机最小系统</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%8A%AF%E7%89%87"><span class="toc-number">3.1.</span> <span class="toc-text">芯片</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%94%B5%E6%BA%90%E7%94%B5%E8%B7%AF"><span class="toc-number">3.2.</span> <span class="toc-text">电源电路</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%97%B6%E9%92%9F%E7%94%B5%E8%B7%AF"><span class="toc-number">3.3.</span> <span class="toc-text">时钟电路</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%8D%E4%BD%8D%E7%94%B5%E8%B7%AF"><span class="toc-number">3.4.</span> <span class="toc-text">复位电路</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%91%E5%85%89%E4%BA%8C%E6%9E%81%E7%AE%A1%EF%BC%88Light-Emitting-Diode%EF%BC%89"><span class="toc-number">4.</span> <span class="toc-text">发光二极管（Light Emitting Diode）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Task1%EF%BC%9A%E5%AE%9E%E7%8E%B0LED%E4%B8%8D%E5%90%8C%E9%A2%91%E7%8E%87%E7%9A%84%E4%BA%AE%E7%81%AD"><span class="toc-number">4.1.</span> <span class="toc-text">Task1：实现LED不同频率的亮灭</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Task2%EF%BC%9A%E6%B5%81%E6%B0%B4%E7%81%AF%EF%BC%88-crol-amp-cror"><span class="toc-number">4.2.</span> <span class="toc-text">Task2：流水灯（ _crol_() &amp; _cror_() )</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E7%A0%81%E7%AE%A1%EF%BC%88SEG"><span class="toc-number">5.</span> <span class="toc-text">数码管（SEG)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%86%E8%A7%89%E6%9A%82%E7%95%99"><span class="toc-number">5.1.</span> <span class="toc-text">视觉暂留</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Task%EF%BC%9A%E9%92%9F%E8%A1%A8"><span class="toc-number">5.2.</span> <span class="toc-text">Task：钟表</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8C%89%E9%94%AE%EF%BC%88KEY"><span class="toc-number">6.</span> <span class="toc-text">按键（KEY)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%8B%AC%E7%AB%8B%E6%8C%89%E9%94%AE"><span class="toc-number">6.1.</span> <span class="toc-text">独立按键</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9F%A9%E9%98%B5%E9%94%AE%E7%9B%98"><span class="toc-number">6.2.</span> <span class="toc-text">矩阵键盘</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%80%90%E8%A1%8C%E6%89%AB%E6%8F%8F%E6%B3%95"><span class="toc-number">6.2.1.</span> <span class="toc-text">逐行扫描法</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BD%8D%E5%8F%8D%E8%BD%AC%E6%B3%95"><span class="toc-number">6.2.2.</span> <span class="toc-text">位反转法</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%AD%E6%96%AD%EF%BC%88INTerrupt%EF%BC%89"><span class="toc-number">7.</span> <span class="toc-text">中断（INTerrupt）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%AD%E6%96%AD%E5%AF%84%E5%AD%98%E5%99%A8"><span class="toc-number">7.1.</span> <span class="toc-text">中断寄存器</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%AD%E6%96%AD%E5%85%81%E8%AE%B8%E6%8E%A7%E5%88%B6%E5%AF%84%E5%AD%98%E5%99%A8%EF%BC%88IE%EF%BC%89"><span class="toc-number">7.1.1.</span> <span class="toc-text">中断允许控制寄存器（IE）</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%AD%E6%96%AD%E4%BC%98%E5%85%88%E6%8E%A7%E5%88%B6%E5%AF%84%E5%AD%98%E5%99%A8%EF%BC%88IP%EF%BC%89"><span class="toc-number">7.1.2.</span> <span class="toc-text">中断优先控制寄存器（IP）</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%AD%E6%96%AD%E8%AF%B7%E6%B1%82%E6%A0%87%E5%BF%97%E5%8F%8A%E5%A4%96%E9%83%A8%E4%B8%AD%E6%96%AD%E9%80%89%E6%8B%A9%E6%8E%A7%E5%88%B6%E5%AF%84%E5%AD%98%E5%99%A8%EF%BC%88TCON%EF%BC%89"><span class="toc-number">7.1.3.</span> <span class="toc-text">中断请求标志及外部中断选择控制寄存器（TCON）</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9A%E6%97%B6-%E8%AE%A1%E6%95%B0%E5%99%A8%E6%8E%A7%E5%88%B6%E5%AF%84%E5%AD%98%E5%99%A8%EF%BC%88TMOD%EF%BC%89"><span class="toc-number">7.1.4.</span> <span class="toc-text">定时\计数器控制寄存器（TMOD）</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%B2%E5%8F%A3%E6%8E%A7%E5%88%B6%E5%AF%84%E5%AD%98%E5%99%A8%EF%BC%88SCON%EF%BC%89"><span class="toc-number">7.1.5.</span> <span class="toc-text">串口控制寄存器（SCON）</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%96%E9%83%A8%E4%B8%AD%E6%96%AD"><span class="toc-number">7.2.</span> <span class="toc-text">外部中断</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9A%E6%97%B6%E4%B8%AD%E6%96%AD"><span class="toc-number">7.3.</span> <span class="toc-text">定时中断</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9A%E6%97%B6%E4%B8%AD%E6%96%AD%E7%BB%93%E6%9E%84"><span class="toc-number">7.3.1.</span> <span class="toc-text">定时中断结构</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9A%E6%97%B6%E5%99%A8%E6%A8%A1%E5%BC%8F-amp-%E8%AE%A1%E6%95%B0%E5%99%A8%E6%A8%A1%E5%BC%8F"><span class="toc-number">7.3.2.</span> <span class="toc-text">定时器模式&amp;计数器模式</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%B7%A5%E4%BD%9C%E6%96%B9%E5%BC%8F%E6%8E%A7%E5%88%B6%E5%AF%84%E5%AD%98%E5%99%A8%EF%BC%88TMOD%EF%BC%89"><span class="toc-number">7.3.3.</span> <span class="toc-text">工作方式控制寄存器（TMOD）</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E5%B7%A5%E4%BD%9C%E6%96%B9%E5%BC%8F"><span class="toc-number">7.3.4.</span> <span class="toc-text">常用工作方式</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%9D%E5%80%BC%E7%9A%84%E8%AE%BE%E5%AE%9A"><span class="toc-number">7.3.5.</span> <span class="toc-text">初值的设定</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B6%B2%E6%99%B6%E6%98%BE%E7%A4%BA%E5%99%A8%EF%BC%88Liquid-Crystal-Display%EF%BC%89"><span class="toc-number">8.</span> <span class="toc-text">液晶显示器（Liquid Crystal Display）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#DDRAM%EF%BC%88%E6%98%BE%E7%A4%BA%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8-RAM"><span class="toc-number">8.1.</span> <span class="toc-text">DDRAM（显示数据存储 RAM)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#CGROM%EF%BC%88%E5%AD%97%E7%AC%A6%E5%AD%98%E5%82%A8ROM%EF%BC%89"><span class="toc-number">8.2.</span> <span class="toc-text">CGROM（字符存储ROM）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#AC%EF%BC%88%E5%9C%B0%E5%9D%80%E8%AE%A1%E6%95%B0%E5%99%A8%EF%BC%89"><span class="toc-number">8.3.</span> <span class="toc-text">AC（地址计数器）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8C%87%E4%BB%A4"><span class="toc-number">8.4.</span> <span class="toc-text">指令</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%B8%85%E5%B1%8F%E6%8C%87%E4%BB%A4"><span class="toc-number">8.4.1.</span> <span class="toc-text">清屏指令</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%85%89%E6%A0%87%E5%BD%92%E4%BD%8D%E6%8C%87%E4%BB%A4"><span class="toc-number">8.4.2.</span> <span class="toc-text">光标归位指令</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%AF%BB%E5%BF%99%E4%BF%A1%E5%8F%B7%E6%88%96AC%E5%9C%B0%E5%9D%80%E6%8C%87%E4%BB%A4"><span class="toc-number">8.4.3.</span> <span class="toc-text">读忙信号或AC地址指令</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E6%8C%87%E4%BB%A4"><span class="toc-number">8.4.4.</span> <span class="toc-text">设置指令</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%97%B6%E5%BA%8F"><span class="toc-number">8.5.</span> <span class="toc-text">时序</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#UART%E9%80%9A%E4%BF%A1"><span class="toc-number">9.</span> <span class="toc-text">UART通信</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%9A%E4%BF%A1"><span class="toc-number">9.1.</span> <span class="toc-text">通信</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%AF%94%E7%89%B9%E7%8E%87-amp-%E6%B3%A2%E7%89%B9%E7%8E%87"><span class="toc-number">9.2.</span> <span class="toc-text">比特率&amp;波特率</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#80C51%E4%B8%B2%E8%A1%8C%E5%8F%A3%E7%BB%93%E6%9E%84"><span class="toc-number">9.3.</span> <span class="toc-text">80C51串行口结构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%AD%E6%96%AD%E5%85%81%E8%AE%B8%E5%AF%84%E5%AD%98%E5%99%A8%EF%BC%88IE%EF%BC%89"><span class="toc-number">9.4.</span> <span class="toc-text">中断允许寄存器（IE）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%B2%E8%A1%8C%E5%8F%A3%E6%8E%A7%E5%88%B6%E5%AF%84%E5%AD%98%E5%99%A8%EF%BC%88SCON%EF%BC%89"><span class="toc-number">9.5.</span> <span class="toc-text">串行口控制寄存器（SCON）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%94%B5%E6%BA%90%E6%8E%A7%E5%88%B6%E5%AF%84%E5%AD%98%E5%99%A8%EF%BC%88PCON%EF%BC%89"><span class="toc-number">9.6.</span> <span class="toc-text">电源控制寄存器（PCON）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B3%A2%E7%89%B9%E7%8E%87%E8%AE%A1%E7%AE%97"><span class="toc-number">9.7.</span> <span class="toc-text">波特率计算</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9C%8B%E9%97%A8%E7%8B%97"><span class="toc-number">10.</span> <span class="toc-text">看门狗</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9C%8B%E9%97%A8%E7%8B%97%E5%AE%9A%E6%97%B6%E5%99%A8%E5%AF%84%E5%AD%98%E5%99%A8%EF%BC%88Watch-Dog-Timer%EF%BC%89"><span class="toc-number">10.1.</span> <span class="toc-text">看门狗定时器寄存器（Watch Dog Timer）</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IIC%E9%80%9A%E4%BF%A1-amp-AT24C02"><span class="toc-number">11.</span> <span class="toc-text">IIC通信&amp;AT24C02</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#IIC"><span class="toc-number">11.1.</span> <span class="toc-text">IIC</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E6%9C%89%E6%95%88%E6%80%A7%E8%A7%84%E5%AE%9A"><span class="toc-number">11.1.1.</span> <span class="toc-text">数据有效性规定</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%B5%B7%E5%A7%8B%E5%92%8C%E7%BB%88%E6%AD%A2%E4%BF%A1%E5%8F%B7"><span class="toc-number">11.1.2.</span> <span class="toc-text">起始和终止信号</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E4%BC%A0%E9%80%81%E6%A0%BC%E5%BC%8F"><span class="toc-number">11.1.3.</span> <span class="toc-text">数据传送格式</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E7%BB%84%E5%90%88"><span class="toc-number">11.1.4.</span> <span class="toc-text">数据组合</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%80%BB%E7%BA%BF%E6%95%B0%E6%8D%AE%E4%BC%A0%E9%80%81%E7%9A%84%E6%A8%A1%E6%8B%9F"><span class="toc-number">11.1.5.</span> <span class="toc-text">总线数据传送的模拟</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%85%B8%E5%9E%8B%E4%BF%A1%E5%8F%B7%E6%A8%A1%E6%8B%9F"><span class="toc-number">11.1.6.</span> <span class="toc-text">典型信号模拟</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#AT24C02"><span class="toc-number">11.2.</span> <span class="toc-text">AT24C02</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%8A%AF%E7%89%87%E5%9C%B0%E5%9D%80"><span class="toc-number">11.2.1.</span> <span class="toc-text">芯片地址</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%86%99"><span class="toc-number">11.2.2.</span> <span class="toc-text">写</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%AF%BB"><span class="toc-number">11.2.3.</span> <span class="toc-text">读</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%95%E6%80%BB%E7%BA%BF%E9%80%9A%E4%BF%A1-amp-DS18B20"><span class="toc-number">12.</span> <span class="toc-text">单总线通信&amp;DS18B20</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8D%95%E6%80%BB%E7%BA%BF"><span class="toc-number">12.1.</span> <span class="toc-text">单总线</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#DS18B20"><span class="toc-number">12.2.</span> <span class="toc-text">DS18B20</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%97%B6%E5%BA%8F-1"><span class="toc-number">12.3.</span> <span class="toc-text">时序</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#85%C2%B0%EF%BC%9F"><span class="toc-number">12.4.</span> <span class="toc-text">85°？</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Task"><span class="toc-number">12.5.</span> <span class="toc-text">Task</span></a></li></ol></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="post-block" itemscope itemtype="https://schema.org/Article"><link itemprop="mainEntityOfPage" href="http://example.com/2021/01/21/AT89C52%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="xudaxia"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="xudaxia的博客"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">AT89C52学习笔记</h1><div class="post-meta"><div class="post-time" style="display:inline-block"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-line"></use></svg></span> <span class="post-meta-icon-text">发表于</span> <time title="创建时间：2021-01-21 23:53:24" itemprop="dateCreated datePublished" datetime="2021-01-21T23:53:24+08:00">2021-01-21</time><span class="post-meta-divider">-</span><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-2-line"></use></svg></span> <span class="post-meta-icon-text">更新于</span> <time title="修改时间：2021-03-30 22:27:56" itemprop="dateModified" datetime="2021-03-30T22:27:56+08:00">2021-03-30</time></div><div class="post-classify"></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body" style="--smc-primary:#0078E7;"><h3 id="单片机"><a href="#单片机" class="headerlink" title="单片机"></a>单片机</h3><p>单片机全称叫单片微型计算机（Single Chip Microcomputer）</p>
<p>我玩的这款是AT89C52</p>
<p>它长这样：<br><a target="_blank" rel="noopener" href="https://imgchr.com/i/s429c6"><img src="https://s3.ax1x.com/2021/01/21/s429c6.jpg" alt="s429c6.jpg" loading="lazy"></a></p>
<p>当然，乍一看到这个板子并不能让人感到快乐，而是十分头大（我只能看到一堆电子器件，这是个什么东西？）</p>
<p>所以玩耍的前提是了解，接下来慢慢讲解单片机的一些基础知识和其一些简单功能的具体实现，而不纠结于其原理。</p>
<h3 id="电平特征"><a href="#电平特征" class="headerlink" title="电平特征"></a>电平特征</h3><p>数字电路中只有两种电平：高电平和低电平<br>高电平：5V或者3.3V，取决单片机电源。<br>低电平：0V</p>
<h3 id="单片机最小系统"><a href="#单片机最小系统" class="headerlink" title="单片机最小系统"></a>单片机最小系统</h3><p><a target="_blank" rel="noopener" href="https://imgchr.com/i/s4R5Q0"><img src="https://s3.ax1x.com/2021/01/21/s4R5Q0.png" alt="s4R5Q0.png" loading="lazy"></a><br>单片机最小系统是由<strong>电源电路</strong>（供电），<strong>时钟电路</strong>（确定基础单位时间），<strong>复位电路</strong>（计算器的归零）构成。</p>
<h4 id="芯片"><a href="#芯片" class="headerlink" title="芯片"></a>芯片</h4><p>单片机上不止一个芯片，上图中的芯片U1有40个<strong>引脚</strong>，其中包括P0,P1,P3,P4这四个并行双向I/O口（input/output口），它们可以在程序的控制下输出高（低）电平或者接受电平。接受电平的状态就是拉高引脚电平的状态，因为有上拉电阻以保证不会被空气里的电磁波干扰而高高低低乱跳（上拉电阻不知道去百度）。暂且不需知道其他的有什么用。</p>
<h4 id="电源电路"><a href="#电源电路" class="headerlink" title="电源电路"></a>电源电路</h4><p>即40引脚。</p>
<p>因为在练习时单片机由电脑通过USB提供电源，以此为契机，我对USB的理解深了许多<del>(一点点)</del>。<br><a target="_blank" rel="noopener" href="https://imgchr.com/i/s4fy5Q"><img src="https://s3.ax1x.com/2021/01/21/s4fy5Q.jpg" alt="s4fy5Q.jpg" loading="lazy"></a>]</p>
<p>直接从百度蒯来图，USB有四根线：1、红线（VCC)提供高电压。2、白线（-D)D指的是data所以白线是负电压数据线<del>（所以什么是负电压数据线我还是不知道）</del>。3、绿线（+D)可与白线类比。4、黑线（GND)提供低电压。可以输出5V左右的电压。</p>
<h4 id="时钟电路"><a href="#时钟电路" class="headerlink" title="时钟电路"></a>时钟电路</h4><p><a target="_blank" rel="noopener" href="https://imgchr.com/i/s4htdU"><img src="https://s3.ax1x.com/2021/01/21/s4htdU.png" alt="s4htdU.png" loading="lazy"></a><br>（如图，不用知道为什么这么画）</p>
<p>晶振（就是图中不是接地线也不是电容的元器件）会提供一个频率（一般为12兆赫）——<strong>晶振频率</strong>（fose)。1/foce称为<strong>时钟周期</strong>。</p>
<p>CPU完成一个基本操作所需要的时间称为<strong>机器周期</strong>。单片机中常把执行一条指令的过程分为几个机器周期。每个机器周期完成一个基本操作，如取指令、读或写数据等等。MCS-51单片机每<strong>12</strong>个时钟周期为一个机器周期，即Tcy=12/fosc。<br>由已知数据可以算得时钟周期为1/12μs，机器周期为1μs。<br>执行任何一条指令时，都可以分为取指令阶段和指令执行阶段 。取指令阶段，可以把程序计数器PC中地址送到程序存储器，并从中取出需要执行指令的操作码和操作数。指令执行阶段可对指令操作码进行译码，以产生一系列控制信号完成指令的执行。一般由1~4个机器周期组成，依据指令不同而不同。</p>
<p>总结来说就是：<strong>指令周期=n*机器周期=n*12*时钟周期</strong></p>
<h4 id="复位电路"><a href="#复位电路" class="headerlink" title="复位电路"></a>复位电路</h4><p><a target="_blank" rel="noopener" href="https://imgchr.com/i/s45TIS"><img src="https://s3.ax1x.com/2021/01/21/s45TIS.png" alt="s45TIS.png" loading="lazy"></a></p>
<p>同样也不清楚原理</p>
<p>复位引脚RST加上大于2个机器周期（即24个时钟振荡周期）的高电平就可使MCS-52复位。</p>
<p>即按下K7按键之后，提供5V电压的VCC与芯片RST引脚连通，RET就被加上了高电平持续两个机器周期后就可完成复位。</p>
<hr>
<p>AT89C52的工作模式为：单片机在程序的指引下，通过线路传递信息完成对单片机上各个部件的控制。</p>
<p>当然这只是一个笼统的甚至不准确的说法，接下来开始具体说明单片机各个模块的应用。</p>
<h3 id="发光二极管（Light-Emitting-Diode）"><a href="#发光二极管（Light-Emitting-Diode）" class="headerlink" title="发光二极管（Light Emitting Diode）"></a>发光二极管（Light Emitting Diode）</h3><p>终于可以开始玩耍了。首先要先了解一下LED的电路。</p>
<p><a target="_blank" rel="noopener" href="https://imgchr.com/i/s47z6J"><img src="https://s3.ax1x.com/2021/01/21/s47z6J.png" alt="s47z6J.png" loading="lazy"></a></p>
<p>先看P3（排针），其在单片机上的具体位置如下：</p>
<p><a target="_blank" rel="noopener" href="https://imgchr.com/i/s4HYcQ"><img src="https://s3.ax1x.com/2021/01/21/s4HYcQ.jpg" alt="s4HYcQ.jpg" loading="lazy"></a></p>
<p>VCC是电源，用跳帽把VCC和VLED相连，VLED就可以相当于电源提供5v电压（VCC与VSEG相连也类似）。</p>
<p>然后看右图，P00~P07对应八个I/O口，它们开始时默认输出高电平（不用知道为什么），所以只要把对应的I/O口调为低电平就可点亮对应的LED灯了。</p>
<pre class="language-none"><code class="language-none">sbit LED&#x3D;P0^1;</code></pre>
<p>sbit 是一个变量类型大小只有一位。</p>
<p>上述定义后，可在程序中通过对LED这个变量的赋值使P01口输出相应的电平，进而控制LED的亮灭。LED赋1输出高电平，LED赋0输出低电平。</p>
<p>也可以给P0整体赋值，P0的值转换为二进制后每一位的值就是相应引脚的值。</p>
<h4 id="Task1：实现LED不同频率的亮灭"><a href="#Task1：实现LED不同频率的亮灭" class="headerlink" title="Task1：实现LED不同频率的亮灭"></a>Task1：实现LED不同频率的亮灭</h4><p>十分简单</p>
<pre class="language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;reg52.h></span></span>

sbit LED<span class="token operator">=</span>P0<span class="token operator">^</span><span class="token number">1</span><span class="token punctuation">;</span>


<span class="token comment">//延时</span>
<span class="token keyword">void</span> <span class="token function">Delay_ms</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> t<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">int</span> i<span class="token punctuation">,</span>j<span class="token punctuation">;</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>t<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
		<span class="token keyword">for</span><span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>j<span class="token operator">&lt;=</span><span class="token number">120</span><span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>


<span class="token comment">//规定时间闪烁</span>
<span class="token keyword">void</span> <span class="token function">Delay_shine_ms</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> t<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
		LED<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
		<span class="token function">Delay_ms</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span>
		LED<span class="token operator">^=</span><span class="token number">1</span><span class="token punctuation">;</span>
		<span class="token function">Delay_ms</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>


<span class="token comment">//主程序</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
	<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
		<span class="token function">Delay_shine_ms</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">Delay_shine_ms</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">Delay_shine_ms</span><span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code></pre>
<p>AT89C52的开发程序的编写对于会C语言的人十分友好，目前只用记住头文件就可以。</p>
<p>本程序中通过跑一个空循环完成延时。（延时1ms大概需要跑110~120次空的for循环，所以用此程序中的delay函数可以做到较为准确的延时）</p>
<h4 id="Task2：流水灯（-crol-amp-cror"><a href="#Task2：流水灯（-crol-amp-cror" class="headerlink" title="Task2：流水灯（ _crol_() &amp; _cror_() )"></a>Task2：流水灯（ _crol_() &amp; _cror_() )</h4><p>本来这个没必要特别说，但是通过流水灯可以学习两个比较有用的函数——_crol_() &amp; _cror_()。</p>
<p>两个函数叫循环左移函数和循环右移函数，顾名思义可以使一个二进制数按位左（右）移。举个例子，循环左移可以把10001000转换为00010001。</p>
<blockquote>
<p>num1=_crol_(num2,x)</p>
</blockquote>
<p>此函数使用时要调用主函数<strong>#include <intrins.h></strong>，需要两个参数num2（循环左移的二进制数）和x（循环移动的位数），此函数有返回值。</p>
<p>_cror_跟_crol_类似不过是循环右移。</p>
<p>通过这两个函数实现的流水灯代码如下：<br><pre class="language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">//头文件</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;reg52.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;intrins.h></span></span>


<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">LED P0</span></span>


<span class="token comment">//宏定义</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression"><span class="token keyword">uint8_t</span>  <span class="token keyword">unsigned</span> <span class="token keyword">char</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression"><span class="token keyword">uint16_t</span> <span class="token keyword">unsigned</span> <span class="token keyword">int</span></span></span>


<span class="token comment">//粗略延时函数</span>
<span class="token keyword">void</span> <span class="token function">delay_ms</span><span class="token punctuation">(</span><span class="token keyword">uint16_t</span> ms<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">uint16_t</span> i<span class="token punctuation">;</span>
    <span class="token keyword">uint8_t</span> j<span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>ms<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>j<span class="token operator">&lt;=</span><span class="token number">115</span><span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>


<span class="token comment">//主函数</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
	LED<span class="token operator">=</span><span class="token number">0xFE</span><span class="token punctuation">;</span>
	<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
		<span class="token function">delay_ms</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		LED<span class="token operator">=</span><span class="token function">_crol_</span><span class="token punctuation">(</span>LED<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code></pre><br>使用次函数代码就会变得十分简洁。</p>
<h3 id="数码管（SEG"><a href="#数码管（SEG" class="headerlink" title="数码管（SEG)"></a>数码管（SEG)</h3><p>这里提一下为什么数码管的简称是SEG。其实SEG是segment的简写，而segment有“片段”的意思，对应数码管的<strong>段选</strong>。（段选和位选的概念在下文会提到）</p>
<p>单个数码管原理图如下：</p>
<p><a target="_blank" rel="noopener" href="https://imgchr.com/i/s4qXff"><img src="https://s3.ax1x.com/2021/01/21/s4qXff.png" alt="s4qXff.png" loading="lazy"></a></p>
<p>数码管其实就是把多个LED放在一起，我们要让数码管显示出数字只需要点亮对应位置的LED。如要显示’1‘就需要把LED：b、c点亮。数码管中的LED一段独立另一端连在一起。中间的com线就是公共端的总线。</p>
<p>一段连在一起的方法显然有两种：</p>
<p><a target="_blank" rel="noopener" href="https://imgchr.com/i/s4LOb9"><img src="https://s3.ax1x.com/2021/01/21/s4LOb9.png" alt="s4LOb9.png" loading="lazy"></a></p>
<p>上图中左边方法的称为<strong>共阴</strong>，右边的叫<strong>共阳</strong>，本单片机的接法是共阳。所以点亮单片机的数码管要给总线高电压并且给对应LED的单独一端的线低电压。</p>
<p>多个数码管按下图方式连接:</p>
<p><a target="_blank" rel="noopener" href="https://imgchr.com/i/s4jec8"><img src="https://s3.ax1x.com/2021/01/21/s4jec8.png" alt="s4jec8.png" loading="lazy"></a></p>
<p>每个数码管的总线称为<strong>位选线</strong>，而没有连在一起的一端的线称为<strong>段选线</strong>。每个数码管对应位置LED的段选线连在一起。</p>
<p>知道了这些就可以看电路图了：</p>
<p><a target="_blank" rel="noopener" href="https://imgchr.com/i/s4jObQ"><img src="https://s3.ax1x.com/2021/01/21/s4jObQ.png" alt="s4jObQ.png" loading="lazy"></a></p>
<p>数码管左侧连的线是段选线，而下边连的线为位选线。位选线这里的电路中含有的三极管起反向的作用，就是如果P17给了低电压经过三极管就会变成高电压，反之亦然。</p>
<p>所以要点亮数码管需要在P1对应的引脚输出低电压，在P0对应引脚输出低电压。</p>
<p>了解电路图后仔细思考，发现这样把所有数码管的对应段选线连在一起的话有一个问题，那就是只能在数码管上显示一样的内容。这样局限性就很大。</p>
<h4 id="视觉暂留"><a href="#视觉暂留" class="headerlink" title="视觉暂留"></a>视觉暂留</h4><p>设计单片机的人显然知道<strong>视觉暂留效应</strong>。</p>
<p>人眼在观察景物时，光信号传入大脑神经，需经过一段短暂的时间，光的作用结束后，视觉形象并不立即消失，这种残留的视觉称“后像”，视觉的这一现象则被称为“视觉暂留”。</p>
<p>利用这个效应，就可以通过快速在单个数码管显示来实现在多个数码管上显示不同数据的效果。</p>
<p>但是一定要在改变段选码（描述对应段选线的引脚P0的二进制码）时一定要在P1输出高电平，改变段选码，再在P1给低电平，否则会出现重影。比如显示“12”时显示完1后如果改变段选码后再改变位选码，那么改变段选码后会现在显示’1‘的数码管上显示’2’（先改变位选码后变段选码也类似），这样的效果相当于显示’1‘和显示’2‘重叠。消除重影的操作叫做<strong>消影</strong>。</p>
<p>并且保留这么设计带来的<strong>简便的优点</strong>。</p>
<h4 id="Task：钟表"><a href="#Task：钟表" class="headerlink" title="Task：钟表"></a>Task：钟表</h4><pre class="language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">//头文件</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;reg52.h></span></span>


<span class="token comment">//宏定义</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression"><span class="token keyword">uint8_t</span>  <span class="token keyword">unsigned</span> <span class="token keyword">char</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression"><span class="token keyword">uint16_t</span> <span class="token keyword">unsigned</span> <span class="token keyword">int</span></span></span>


<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">BIT P1</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">SEGMENT P0</span></span>

<span class="token comment">//定义字符码表和位选码</span>
<span class="token keyword">uint8_t</span> code segment_code<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
	<span class="token number">0XC0</span><span class="token punctuation">,</span><span class="token number">0XF9</span><span class="token punctuation">,</span><span class="token number">0XA4</span><span class="token punctuation">,</span><span class="token number">0XB0</span><span class="token punctuation">,</span><span class="token number">0X99</span><span class="token punctuation">,</span><span class="token number">0X92</span><span class="token punctuation">,</span><span class="token number">0X82</span><span class="token punctuation">,</span><span class="token number">0XF8</span><span class="token punctuation">,</span><span class="token number">0X80</span><span class="token punctuation">,</span><span class="token number">0X90</span> <span class="token comment">//对应0-9的字符</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token comment">//段码</span>

<span class="token keyword">uint8_t</span> code bit_code<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
     <span class="token number">0XFE</span><span class="token punctuation">,</span><span class="token number">0XFD</span><span class="token punctuation">,</span><span class="token number">0XFB</span><span class="token punctuation">,</span><span class="token number">0XF7</span><span class="token punctuation">,</span><span class="token number">0XEF</span><span class="token punctuation">,</span><span class="token number">0XDF</span><span class="token punctuation">,</span><span class="token number">0XBF</span><span class="token punctuation">,</span><span class="token number">0X7F</span> <span class="token comment">//对应8位数码管</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token comment">//位码</span>


<span class="token comment">//粗略延时函数</span>
<span class="token keyword">void</span> <span class="token function">delay_ms</span><span class="token punctuation">(</span><span class="token keyword">uint16_t</span> ms<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">uint16_t</span> i<span class="token punctuation">;</span>
    <span class="token keyword">uint8_t</span> j<span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>ms<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>j<span class="token operator">&lt;=</span><span class="token number">115</span><span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>


<span class="token keyword">void</span> <span class="token function">deplay_2bit</span><span class="token punctuation">(</span><span class="token keyword">uint8_t</span> p<span class="token punctuation">,</span><span class="token keyword">uint8_t</span> n<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
	BIT<span class="token operator">=</span><span class="token number">0x00</span><span class="token punctuation">;</span>
	SEGMENT<span class="token operator">=</span>segment_code<span class="token punctuation">[</span>n<span class="token operator">%</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	BIT<span class="token operator">=</span>bit_code<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token function">delay_ms</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	BIT<span class="token operator">=</span><span class="token number">0x00</span><span class="token punctuation">;</span>
	SEGMENT<span class="token operator">=</span>segment_code<span class="token punctuation">[</span>n<span class="token operator">/</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	BIT<span class="token operator">=</span>bit_code<span class="token punctuation">[</span>p<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token function">delay_ms</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>


<span class="token keyword">void</span> <span class="token function">deplay</span><span class="token punctuation">(</span><span class="token keyword">uint8_t</span> s<span class="token punctuation">,</span><span class="token keyword">uint8_t</span> m<span class="token punctuation">,</span><span class="token keyword">uint8_t</span> h<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
	<span class="token function">deplay_2bit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
	
	BIT<span class="token operator">=</span><span class="token number">0x00</span><span class="token punctuation">;</span>
	SEGMENT<span class="token operator">=</span><span class="token number">0xBF</span><span class="token punctuation">;</span>
	BIT<span class="token operator">=</span>bit_code<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token function">delay_ms</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	
	<span class="token function">deplay_2bit</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span>m<span class="token punctuation">)</span><span class="token punctuation">;</span>
	
	BIT<span class="token operator">=</span><span class="token number">0x00</span><span class="token punctuation">;</span>
	SEGMENT<span class="token operator">=</span><span class="token number">0xBF</span><span class="token punctuation">;</span>
	BIT<span class="token operator">=</span>bit_code<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token function">delay_ms</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	
	<span class="token function">deplay_2bit</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span>h<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>


<span class="token comment">//主函数</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
	<span class="token keyword">uint8_t</span> s<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>h<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>m<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>cnt1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>cnt2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
	BIT<span class="token operator">=</span><span class="token number">0x00</span><span class="token punctuation">;</span>
	<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
		<span class="token function">deplay</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span>m<span class="token punctuation">,</span>h<span class="token punctuation">)</span><span class="token punctuation">;</span>
		cnt1<span class="token operator">++</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>cnt1<span class="token operator">==</span><span class="token number">70</span><span class="token punctuation">)</span>s<span class="token operator">++</span><span class="token punctuation">,</span>cnt1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>s<span class="token operator">==</span><span class="token number">60</span><span class="token punctuation">)</span>m<span class="token operator">++</span><span class="token punctuation">,</span>s<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>m<span class="token operator">==</span><span class="token number">60</span><span class="token punctuation">)</span>h<span class="token operator">++</span><span class="token punctuation">,</span>m<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>h<span class="token operator">==</span><span class="token number">24</span><span class="token punctuation">)</span>h<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>	
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code></pre>
<p>比较简单</p>
<h3 id="按键（KEY"><a href="#按键（KEY" class="headerlink" title="按键（KEY)"></a>按键（KEY)</h3><p>应用键盘就是判断按键是否闭合，并完成对应闭合按键的操作。</p>
<h4 id="独立按键"><a href="#独立按键" class="headerlink" title="独立按键"></a>独立按键</h4><p><a target="_blank" rel="noopener" href="https://imgchr.com/i/s4ztjf"><img src="https://s3.ax1x.com/2021/01/21/s4ztjf.png" alt="s4ztjf.png" loading="lazy"></a></p>
<p>简洁，朴实无华。当按键没按下时，相对应的IO接口由于内部有上 拉电阻，其输入为高电平 当某个按键按下后，对应的IO接口变成低电平， 只要在程序中判断IO接口的状态即可知道哪个键属于闭合状态。</p>
<p>参考代码</p>
<pre class="language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">void</span> <span class="token function">get_key</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>K1<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
		<span class="token function">delay_ms</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>K1<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span>value<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
		<span class="token keyword">while</span><span class="token punctuation">(</span>K1<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>K2<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
		<span class="token function">delay_ms</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>K2<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span>value<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>
		<span class="token keyword">while</span><span class="token punctuation">(</span>K2<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>K3<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
		<span class="token function">delay_ms</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>K3<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span>value<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">;</span>
		<span class="token keyword">while</span><span class="token punctuation">(</span>K3<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>K4<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
		<span class="token function">delay_ms</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>K4<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span>value<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">;</span>
		<span class="token keyword">while</span><span class="token punctuation">(</span>K4<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code></pre>
<h4 id="矩阵键盘"><a href="#矩阵键盘" class="headerlink" title="矩阵键盘"></a>矩阵键盘</h4><p><img src="https://www.hualigs.cn/image/6052c59bcda83.jpg" alt="" loading="lazy"></p>
<p>复杂了很多。</p>
<h5 id="逐行扫描法"><a href="#逐行扫描法" class="headerlink" title="逐行扫描法"></a>逐行扫描法</h5><p>一种自然一点的判断按键闭合的方式是逐行扫描。然后问题就是如何判断一行中那些按键闭合。</p>
<p>以判断第一行为例。先给P27一个低电平检查P23,P22,P21,P20的状态。如果这行的一个按键被按下，P20~P23中的唯一对应引脚就会和低电平连接使自己电平变低。</p>
<p>所以检查哪个引脚电平为低说明对应的按键被按下。</p>
<h5 id="位反转法"><a href="#位反转法" class="headerlink" title="位反转法"></a>位反转法</h5><p>还有一种不是非常自然的方法是先把P24~P27的电平变低，通过检查P20~P23的状态就可以知道按下的按键在哪一列。然后用同样的方法判断按键在哪一行就可以找到按下的按键了。<br>但这个方法有个弊端：如果K22和K33同时按下（这里的同时只是假设，但在某些情况下确实会出现这种情况）就会产生错误。</p>
<hr>
<p>一般用位反转法多一些。</p>
<p>其代码如下：</p>
<pre class="language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">//获得矩阵键盘的值</span>
<span class="token keyword">void</span> <span class="token function">get_key</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
	GPIO_KEY<span class="token operator">=</span><span class="token number">0x0f</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>GPIO_KEY<span class="token operator">!=</span><span class="token number">0x0f</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
		<span class="token function">delay_ms</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>GPIO_KEY<span class="token operator">!=</span><span class="token number">0x0f</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
			GPIO_KEY<span class="token operator">=</span><span class="token number">0x0f</span><span class="token punctuation">;</span>
			<span class="token keyword">switch</span><span class="token punctuation">(</span>GPIO_KEY<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
				<span class="token keyword">case</span> <span class="token number">0x07</span><span class="token operator">:</span>value<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span>
				<span class="token keyword">case</span> <span class="token number">0x0b</span><span class="token operator">:</span>value<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span>
				<span class="token keyword">case</span> <span class="token number">0x0d</span><span class="token operator">:</span>value<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span>
				<span class="token keyword">case</span> <span class="token number">0x0e</span><span class="token operator">:</span>value<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span>
			<span class="token punctuation">&#125;</span>
			GPIO_KEY<span class="token operator">=</span><span class="token number">0xf0</span><span class="token punctuation">;</span>
			<span class="token keyword">switch</span><span class="token punctuation">(</span>GPIO_KEY<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
				<span class="token keyword">case</span> <span class="token number">0x70</span><span class="token operator">:</span><span class="token keyword">break</span><span class="token punctuation">;</span>
				<span class="token keyword">case</span> <span class="token number">0xb0</span><span class="token operator">:</span>value<span class="token operator">+=</span><span class="token number">4</span><span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span>
				<span class="token keyword">case</span> <span class="token number">0xd0</span><span class="token operator">:</span>value<span class="token operator">+=</span><span class="token number">8</span><span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span>
				<span class="token keyword">case</span> <span class="token number">0xe0</span><span class="token operator">:</span>value<span class="token operator">+=</span><span class="token number">12</span><span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span>
			<span class="token punctuation">&#125;</span>
			<span class="token keyword">while</span><span class="token punctuation">(</span>GPIO_KEY<span class="token operator">!=</span><span class="token number">0xf0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
				GPIO_KEY<span class="token operator">=</span><span class="token number">0xf0</span><span class="token punctuation">;</span>
				<span class="token function">delay_ms</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">&#125;</span>
		<span class="token punctuation">&#125;</span>
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code></pre>
<p>最后的while是松手检测，在按键抬起后才会离开这个while，起到离散化按键操作的作用。</p>
<p>最后提一下这里</p>
<pre class="language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">if</span><span class="token punctuation">(</span>GPIO_KEY<span class="token operator">!=</span><span class="token number">0x0f</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
	<span class="token function">delay_ms</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>GPIO_KEY<span class="token operator">!=</span><span class="token number">0x0f</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
		<span class="token comment">//balabala...</span>
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code></pre>
<p>为什么要在判断后延时几毫秒重新判断呢？</p>
<p><a target="_blank" rel="noopener" href="https://imgchr.com/i/s591N4"><img src="https://s3.ax1x.com/2021/01/21/s591N4.png" alt="s591N4.png" loading="lazy"></a></p>
<p>按键闭合后电压并不是立刻改变，所以需要延时几毫秒消除电压抖动的影响简称<strong>消抖</strong>。</p>
<p><del>但是我有没有消抖似乎一点影响都没有</del></p>
<h3 id="中断（INTerrupt）"><a href="#中断（INTerrupt）" class="headerlink" title="中断（INTerrupt）"></a>中断（INTerrupt）</h3><p>什么是中断呢？简单来说就是单边机在执行程序时因为原因去执行指定函数，并在结束时回到原程序进程的过程。</p>
<p>更直观的表示：</p>
<p><a target="_blank" rel="noopener" href="https://imgchr.com/i/yPfHXQ"><img src="https://s3.ax1x.com/2021/01/29/yPfHXQ.png" alt="yPfHXQ.png" loading="lazy"></a></p>
<p>52单片机有<strong>6个中断源</strong>（引起CPU中断的根源）。其中<strong>2个</strong>外部中断INT0、INT1，当这两个<strong>按键</strong>其中一个被按下时，就会产生中断。还有<strong>3个</strong>定时器/计数器中断T0、T1、T2，我们可以设置它们的初始值和阀值，当它们定时、计数溢出时就会产生中断。还有<strong>1个</strong>串行口中断TI/RI，串行端口完成一帧字符发送/接受后引起中断，这个在串口通信时再说。</p>
<p>中断源有<strong>优先级</strong>，优先级高的中断源引起的中断可以中断优先级低的中断服务程序，反之则不行。中断源的优先级如下。</p>
<p><a target="_blank" rel="noopener" href="https://imgchr.com/i/yPLHw8"><img src="https://s3.ax1x.com/2021/01/29/yPLHw8.png" alt="yPLHw8.png" loading="lazy"></a></p>
<h4 id="中断寄存器"><a href="#中断寄存器" class="headerlink" title="中断寄存器"></a>中断寄存器</h4><h5 id="中断允许控制寄存器（IE）"><a href="#中断允许控制寄存器（IE）" class="headerlink" title="中断允许控制寄存器（IE）"></a>中断允许控制寄存器（IE）</h5><p><a target="_blank" rel="noopener" href="https://imgchr.com/i/yPjvSH"><img src="https://s3.ax1x.com/2021/01/29/yPjvSH.png" alt="yPjvSH.png" loading="lazy"></a></p>
<p>相当于中断的开关阀门，默认每位为0。</p>
<p>总共有8位其中<strong>第七位为空</strong>。控制对应的中断开启和关闭。对应位为1代表中断开启，如果是0代表中断关闭。</p>
<p>EX0(IE.0)：外部中断0</p>
<p>ET0(IE.1)：定时器\计数器中断0</p>
<p>EX1(IE.2)：外部中断1</p>
<p>ET1(IE.3)：定时器\计数器中断1</p>
<p>ES(IE.4)：串行口中断</p>
<p>ET2(IE.5)：定时器\计数器中断2</p>
<p>EA(IE.7)：总中断</p>
<h5 id="中断优先控制寄存器（IP）"><a href="#中断优先控制寄存器（IP）" class="headerlink" title="中断优先控制寄存器（IP）"></a>中断优先控制寄存器（IP）</h5><p><a target="_blank" rel="noopener" href="https://imgchr.com/i/yPzKiT"><img src="https://s3.ax1x.com/2021/01/29/yPzKiT.png" alt="yPzKiT.png" loading="lazy"></a></p>
<p>其中第7、8位为空。非空的6位对应关系与IE相同。</p>
<p>前文提到中断有一个默认的优先级，除此之外我们还可以利用这个寄存器自己定义优先级。对应位改成1，中断的优先级就改为高级。否则为默认的0即中断优先级为低级。</p>
<p>优先级比较时，先比较寄存器中设定为高还是低然后比较默认优先级。</p>
<h5 id="中断请求标志及外部中断选择控制寄存器（TCON）"><a href="#中断请求标志及外部中断选择控制寄存器（TCON）" class="headerlink" title="中断请求标志及外部中断选择控制寄存器（TCON）"></a>中断请求标志及外部中断选择控制寄存器（TCON）</h5><p><a target="_blank" rel="noopener" href="https://imgchr.com/i/yi94SO"><img src="https://s3.ax1x.com/2021/01/29/yi94SO.png" alt="yi94SO.png" loading="lazy"></a></p>
<p>这个寄存器比较复杂，如同它的名字一样，可以把它的功能分成两（三）部分。</p>
<p><strong>1、中断请求标志控制</strong></p>
<p>IE0：外部中断0中断请求标志位。</p>
<p>IE1：外部中断1中断请求标志位。</p>
<p>TF0：定时/计数器T0溢出中断请求标志位。</p>
<p>TF1：定时/计数器T1溢出中断请求标志位。</p>
<p>出现中断信号时会由0变为1，向CPU发送中断请求。然后会自动变为0。<br>并没有什么用的东西。</p>
<p><strong>2、外部中断选择控制</strong></p>
<p>IT0：外部中断0触发方式控制位。 </p>
<p>IT1：外部中断1触发方式控制位。</p>
<p>当为0时，为电平触发方式。当为1时，为边沿触发方式（下降沿有效）。<br>（PS：下降沿是指由高电平到低电平的电平变化<strong>过程</strong>）</p>
<p><strong>叁、计数\定时器运行控制</strong></p>
<p>TR0：T0运行控制位。</p>
<p>TR1：T1运行控制位。</p>
<p>默认为0，设为1才可运行对应计数\定时器。</p>
<p>（所以要打开<strong>1个</strong>计数\定时器要保证<strong>3个</strong>寄存器位开启）</p>
<h5 id="定时-计数器控制寄存器（TMOD）"><a href="#定时-计数器控制寄存器（TMOD）" class="headerlink" title="定时\计数器控制寄存器（TMOD）"></a>定时\计数器控制寄存器（TMOD）</h5><h5 id="串口控制寄存器（SCON）"><a href="#串口控制寄存器（SCON）" class="headerlink" title="串口控制寄存器（SCON）"></a>串口控制寄存器（SCON）</h5><p>这两个个后文再说</p>
<h4 id="外部中断"><a href="#外部中断" class="headerlink" title="外部中断"></a>外部中断</h4><p>初始化如下：</p>
<pre class="language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">void</span> <span class="token function">INT_init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
	EA<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
	EX0<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
	IT0<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
	EX1<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
	IT1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code></pre>
<p>中断服务程序书写格式：</p>
<pre class="language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">void</span> 函数名（）interrupt 中断号<span class="token punctuation">&#123;</span>
	中断服务程序内容
<span class="token punctuation">&#125;</span></code></pre>
<p>注意：中断函数不能有返回值 函数名可以自己取，不能与C语言关键字同 不带参数，所以括号为空 interrupt是关键字，不能变 中断号代表优先级0—5</p>
<p>参考代码</p>
<pre class="language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">void</span> <span class="token function">INT_0</span><span class="token punctuation">(</span><span class="token punctuation">)</span> interrupt <span class="token number">0</span><span class="token punctuation">&#123;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>KEY_INT0<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
		<span class="token function">delay_ms</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>KEY_INT0<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span>w1<span class="token operator">++</span><span class="token punctuation">;</span>
		<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">!</span>KEY_INT0<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code></pre>
<p>跟独立按键差不多。</p>
<h4 id="定时中断"><a href="#定时中断" class="headerlink" title="定时中断"></a>定时中断</h4><p>还需要补充亿点内容。</p>
<h5 id="定时中断结构"><a href="#定时中断结构" class="headerlink" title="定时中断结构"></a>定时中断结构</h5><p>上文提到外部中断由按下按键处罚，而<strong>定时中断的结构是：</strong>单片机拥有两个16位计数\定时器——T0、T1。2个16位定时器实际上都是<strong>16位加1计数器</strong>。T0 由2个8位特殊功能寄存器TH0和TL0构成，T1由TH1 和TL1构成。 每个定时器都可由软件设置为定时工作方式或计数工作方式。 这些功能都由特殊功能寄存器TMOD设置和TCON所控制。</p>
<h5 id="定时器模式-amp-计数器模式"><a href="#定时器模式-amp-计数器模式" class="headerlink" title="定时器模式&amp;计数器模式"></a>定时器模式&amp;计数器模式</h5><p>加1计数器输入的<strong>计数脉冲</strong>有两个来源,一个是由 系统的时钟振荡器输出脉冲经12分频后送来（对应<strong>定时器模式</strong>）；一个 是T0或T1引脚输入的外部脉冲源（对应<strong>计数器模式</strong>，了解即可）。每来一个脉冲计 数器加1，当加到计数器为全1时，再输入一个脉冲 就使计数器回零，且计数器的溢出使TCON中TF0或 TF1置1，向CPU发出中断请求（定时/计数器中断允 许时）。如果定时/计数器工作于定时模式，则表示 定时时间已到；如果工作于计数模式，则表示计数值已满。</p>
<p>本文只讲解定时器模式。</p>
<h5 id="工作方式控制寄存器（TMOD）"><a href="#工作方式控制寄存器（TMOD）" class="headerlink" title="工作方式控制寄存器（TMOD）"></a>工作方式控制寄存器（TMOD）</h5><p>这里还要介绍一个用来控制计时器工作方式的<strong>寄存器——TMOD</strong></p>
<p><a target="_blank" rel="noopener" href="https://imgchr.com/i/yiIok9"><img src="https://s3.ax1x.com/2021/01/29/yiIok9.png" alt="yiIok9.png" loading="lazy"></a></p>
<p>GATE：门控位。GATE＝0时，只要用软件使 TCON中的TR0或TR1为1，就可以启动定时/计数器工作；GATA＝1时，要用软件使TR0或TR1为1，同时外部中断引脚（INT0和INT1）也为高电平时，才能启动定时/计数器工作。即此时定时器的启动条件， 加上了并且引脚为高电平这一条件。<br>C/T:定时/计数模式选择位。 C/T＝0为定时模式，C/T=1为计数模式。<br>M1M0：工作方式设置位。定时/计数器有四种工作方式，由M1M0进行设置。</p>
<h5 id="常用工作方式"><a href="#常用工作方式" class="headerlink" title="常用工作方式"></a>常用工作方式</h5><p><strong>常用的工作方式为1和2</strong>，分别对应M1M0为01和10。</p>
<p>以定时\计数器0为例：</p>
<p>方式1的计数位数是16位，由TL0作为低8位、 TH0作为高8位，组成了16位加1计数器 。显然最大值为65535，需要手动富赋初值。</p>
<p>方式2为自动重装初值的8位计数方式。TH0作为预装初值的8位，TL0为计数主体的8。这是最大值为32767，当TL0溢出时，自动变为TH0中的值。</p>
<h5 id="初值的设定"><a href="#初值的设定" class="headerlink" title="初值的设定"></a>初值的设定</h5><p>根据一个脉冲是机器周期（晶振周期的12倍）。随便算。</p>
<p>初始化程序如下：</p>
<pre class="language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">Timer0_ms <span class="token number">20</span>                             </span><span class="token comment">//定时器0定时长度</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">Timer1_ms <span class="token number">1</span>                              </span><span class="token comment">//定时器1定时长度</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">FSOC      <span class="token number">12000000L</span>                      </span><span class="token comment">//晶振频率</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression"><span class="token function">T1ms</span>      <span class="token punctuation">(</span><span class="token number">65536</span> <span class="token operator">-</span> FSOC <span class="token operator">/</span> <span class="token number">12</span> <span class="token operator">/</span> <span class="token number">1000</span><span class="token punctuation">)</span>     </span><span class="token comment">//工作在方式1定时1ms的初值</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression"><span class="token function">Tx_ms</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>  <span class="token punctuation">(</span><span class="token number">65536</span> <span class="token operator">-</span> x <span class="token operator">*</span> FSOC <span class="token operator">/</span> <span class="token number">12</span> <span class="token operator">/</span> <span class="token number">1000</span><span class="token punctuation">)</span> </span><span class="token comment">//工作在方式1定时xms的初值</span></span>
    
    
<span class="token comment">//定时器0初始化</span>
<span class="token keyword">void</span> <span class="token function">Timer0_init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    TMOD<span class="token operator">|=</span><span class="token number">0x01</span><span class="token punctuation">;</span>  <span class="token comment">//定时器0工作在方式</span>
    TH0<span class="token operator">=</span><span class="token function">Tx_ms</span><span class="token punctuation">(</span>Timer0_ms<span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">256</span><span class="token punctuation">;</span>  <span class="token comment">//初值填充，高8位</span>
    TL0<span class="token operator">=</span><span class="token function">Tx_ms</span><span class="token punctuation">(</span>Timer0_ms<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">256</span><span class="token punctuation">;</span>  <span class="token comment">//初值填充，低8位</span>
    EA<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>  <span class="token comment">//全局中断开，IE</span>
    ET0<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>  <span class="token comment">//定时器0中断开，IE</span>
    TR0<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>  <span class="token comment">//定时器0启动</span>
<span class="token punctuation">&#125;</span>


<span class="token comment">//定时器1初始化</span>
<span class="token keyword">void</span> <span class="token function">Timer1_init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    TMOD<span class="token operator">|=</span><span class="token number">0x10</span><span class="token punctuation">;</span>  <span class="token comment">//定时器0工作在方式</span>
    TH1<span class="token operator">=</span><span class="token function">Tx_ms</span><span class="token punctuation">(</span>Timer1_ms<span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">256</span><span class="token punctuation">;</span>  <span class="token comment">//初值填充，高8位</span>
    TL1<span class="token operator">=</span><span class="token function">Tx_ms</span><span class="token punctuation">(</span>Timer1_ms<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">256</span><span class="token punctuation">;</span>  <span class="token comment">//初值填充，低8位</span>
    EA<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>  <span class="token comment">//全局中断开，IE</span>
    ET1<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>  <span class="token comment">//定时器1中断开，IE</span>
    TR1<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>  <span class="token comment">//定时器1启动</span>
<span class="token punctuation">&#125;</span></code></pre>
<p>在工作模式为1的定时中断程序中一定要记得把初值重新赋给计时器。</p>
<p>参考代码</p>
<pre class="language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">void</span> <span class="token function">Timer0</span><span class="token punctuation">(</span><span class="token punctuation">)</span> interrupt <span class="token number">1</span><span class="token punctuation">&#123;</span>
	balabala<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    TH0<span class="token operator">=</span><span class="token function">Tx_ms</span><span class="token punctuation">(</span>Timer0_ms<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">256</span><span class="token punctuation">;</span>  <span class="token comment">//初值填充，高8位</span>
    TL0<span class="token operator">=</span><span class="token function">Tx_ms</span><span class="token punctuation">(</span>Timer0_ms<span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">256</span><span class="token punctuation">;</span>  <span class="token comment">//初值填充，低8位</span>
    balabala<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">&#125;</span></code></pre>
<h3 id="液晶显示器（Liquid-Crystal-Display）"><a href="#液晶显示器（Liquid-Crystal-Display）" class="headerlink" title="液晶显示器（Liquid Crystal Display）"></a>液晶显示器（Liquid Crystal Display）</h3><p>液晶简单来说就是有液体流动性的晶体。<br>“液晶显示材料具有明显的优点:驱动电压低、功耗微小、可靠性高、显示信息量大、彩色显示、无闪烁、对人体无危害、生产过程自动化、成本低廉、可以制成各种规格和类型的液晶显示器,便于携带等。由于这些优点。用液晶材料制成的计算机终端和电视可以大幅度减小体积等。</p>
<p>本人用的型号为LCD1602,它是这个样子的：</p>
<p><a target="_blank" rel="noopener" href="https://imgchr.com/i/ytw3Y6"><img src="https://s3.ax1x.com/2021/02/07/ytw3Y6.jpg" alt="ytw3Y6.jpg" loading="lazy"></a></p>
<p>顾名思义，只能显示2行16列的液晶。因为一些特性，显示图像的能力不足，所以一般用来显示文本数字。</p>
<p>其电路图如下：</p>
<p><a target="_blank" rel="noopener" href="https://imgchr.com/i/ytwNOH"><img src="https://s3.ax1x.com/2021/02/07/ytwNOH.jpg" alt="ytwNOH.jpg" loading="lazy"></a></p>
<p>其中:</p>
<p>3号引脚：提供液晶显示偏压信号。以引脚电压与标准电压的差距来调节液晶的对比度。</p>
<p>（PS：对比度指的是一幅图像中明暗区域最亮的白和最暗的黑之间不同亮度层级的测量，差异范围越大代表对比越大，差异范围越小代表对比越小。）</p>
<p><strong>4号引脚（RS）</strong>：数据指令选择位。1：读写数据。0：读写指令。由P10控制。</p>
<p><strong>5号引脚（RW）</strong>：读写选择位。1：读。0：写。由P11控制。</p>
<p><strong>6号引脚（EN）</strong>：读写开关位。1：可做读/写操作。0：不可做读/写操作。由P12控制。</p>
<p>7~14号引脚对应双向数据总线的0~7位。与P0相连。</p>
<p>15号引脚是背光显示器电源。</p>
<p>16号引脚是背光显示器接地。</p>
<p>这里解释一下背光显示器。就是在LCD背面的一个LED。可以让屏幕更亮一些。<br><a target="_blank" rel="noopener" href="https://imgchr.com/i/ytrp90"><img src="https://s3.ax1x.com/2021/02/07/ytrp90.jpg" alt="ytrp90.jpg" loading="lazy"></a><br>可用此图与开始的图对比。</p>
<p>LCD1602的引脚与单片机引脚的连接情况是:<br>4~6——&gt;P10~P12<br>7~14——&gt;P00~P07</p>
<h4 id="DDRAM（显示数据存储-RAM"><a href="#DDRAM（显示数据存储-RAM" class="headerlink" title="DDRAM（显示数据存储 RAM)"></a>DDRAM（显示数据存储 RAM)</h4><p>DDRAM就是显示数据RAM，用来寄存待显示的字符代码。只要将<strong>标准的ASCⅡ码</strong>送入DDRAM，内部控制电路会自动将数据传送到显示器上。共80个字节，其地址和屏幕的对应关系如下图：</p>
<p><a target="_blank" rel="noopener" href="https://imgchr.com/i/ytyT91"><img src="https://s3.ax1x.com/2021/02/07/ytyT91.png" alt="ytyT91.png" loading="lazy"></a></p>
<p>虽然DDRAM总共有80个字节可供控制显示，但是我们只用第一行的前16个字节和第二行的前16个字节。因为一行最多只能显示16个ASCII码。</p>
<p>注意：如果要在一个地址显示数字需要在对应地址上<strong>加0x80</strong>。</p>
<h4 id="CGROM（字符存储ROM）"><a href="#CGROM（字符存储ROM）" class="headerlink" title="CGROM（字符存储ROM）"></a>CGROM（字符存储ROM）</h4><p>1602液晶模块内部的字符发生存储器(Character Generator ROM，简称CGROM)已经存储了192个5×7的不同的点阵字符图形，这些字符有：阿拉伯数字、英文字母的大小写、常用的符号、和日文假名等，每一个字符都有一个固定的代码，比如大写的英文字母“A”的代码是01000001B（41H），显示时模块把地址41H中的点 阵字符图形显示出来，我们就能看到字母“A”。</p>
<h4 id="AC（地址计数器）"><a href="#AC（地址计数器）" class="headerlink" title="AC（地址计数器）"></a>AC（地址计数器）</h4><p>负责计数写到CGRAM、DDRAM数据的地址，或从DDRAM、CGRAM读出数据的地址。</p>
<h4 id="指令"><a href="#指令" class="headerlink" title="指令"></a>指令</h4><p>指令由P0决定。</p>
<h5 id="清屏指令"><a href="#清屏指令" class="headerlink" title="清屏指令"></a>清屏指令</h5><p>功能：</p>
<p>1、清除液晶显示器， 即将DDRAM的内容全部填入“空白”的字符码20H。</p>
<p>2、光标归位，将光标撤回液晶显示屏的左上方。</p>
<p>3、将地址计数器(AC)的值设为0；</p>
<p>指令格式为：</p>
<p>01H</p>
<p>00000001</p>
<p>即7~14引脚对应数值为0x01</p>
<h5 id="光标归位指令"><a href="#光标归位指令" class="headerlink" title="光标归位指令"></a>光标归位指令</h5><p>功能：</p>
<p>1、把光标撤回至屏幕左上方。</p>
<p>2、把地址计数器(AC)的值设置为0</p>
<p>(DDRAM的内容不变)</p>
<p>指令格式为：</p>
<p>02H</p>
<p>0000001x</p>
<p>x表示最后一位可以是任何值</p>
<h5 id="读忙信号或AC地址指令"><a href="#读忙信号或AC地址指令" class="headerlink" title="读忙信号或AC地址指令"></a>读忙信号或AC地址指令</h5><p>这是读取指令，读到的数据格式为：</p>
<p>xyyyyyyy</p>
<p>其中x是LCD1602是否忙碌的标志：x=1则表示显示器忙，0就是不忙。</p>
<p>y是AC的值。</p>
<h5 id="设置指令"><a href="#设置指令" class="headerlink" title="设置指令"></a>设置指令</h5><p>重要但可以认为是个性化设置不需要掌握。与操作指令相对。</p>
<p>这里提一下设定DDRAM指令：</p>
<p>其格式为：</p>
<p>80H</p>
<p>1xxxxxxxx</p>
<p>xxxxxxx代表DDRAM的地址。</p>
<p>这也是为什么一开始说写DDRAM地址命令时要加上0x80的原因。</p>
<h4 id="时序"><a href="#时序" class="headerlink" title="时序"></a>时序</h4><p>就是一种通信协议。</p>
<p>这个协议由硬件决定，比如在输出数据后需要多少时间显示器可以确保接收到？</p>
<p>所以需要一个标准来确保使用液晶时不出现意外。这个标准就是时序。</p>
<p>要详细理解并知晓LCD1602的时序请走传送门。</p>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV18E411L7E3">传送门</a></p>
<p>模板：<br><pre class="language-cpp" data-language="cpp"><code class="language-cpp">sbit LCD_RS<span class="token operator">=</span>P1<span class="token operator">^</span><span class="token number">0</span><span class="token punctuation">;</span>
sbit LCD_RW<span class="token operator">=</span>P1<span class="token operator">^</span><span class="token number">1</span><span class="token punctuation">;</span>
sbit LCD_EN<span class="token operator">=</span>P1<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">;</span>


<span class="token comment">//判断液晶是否忙碌</span>
bit <span class="token function">LCD_busy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
	bit result<span class="token punctuation">;</span>
	LCD_RS<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
	LCD_RW<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
	LCD_EN<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token function">delay_ms</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	result<span class="token operator">=</span><span class="token punctuation">(</span>bit<span class="token punctuation">)</span><span class="token punctuation">(</span>P0<span class="token operator">&amp;</span><span class="token number">0x80</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//只有第八位是有关忙碌的值</span>
	LCD_EN<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>


<span class="token comment">//写命令</span>
<span class="token keyword">void</span> <span class="token function">LCD_wcmd</span><span class="token punctuation">(</span><span class="token keyword">uint8_t</span> cmd<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
	<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token function">LCD_busy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	LCD_RS<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
	LCD_RW<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
	LCD_EN<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
	P0<span class="token operator">=</span>cmd<span class="token punctuation">;</span>
	<span class="token function">delay_ms</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	LCD_EN<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token function">delay_ms</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	LCD_EN<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>


<span class="token comment">//写数据</span>
<span class="token keyword">void</span> <span class="token function">LCD_wdat</span><span class="token punctuation">(</span><span class="token keyword">uint8_t</span> dat<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
	<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token function">LCD_busy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	LCD_RS<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
	LCD_RW<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
	LCD_EN<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
	P0<span class="token operator">=</span>dat<span class="token punctuation">;</span>
	<span class="token function">delay_ms</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	LCD_EN<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token function">delay_ms</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	LCD_EN<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>


<span class="token comment">//清零</span>
<span class="token keyword">void</span> <span class="token function">LCD_clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
	<span class="token function">LCD_wcmd</span><span class="token punctuation">(</span><span class="token number">0x01</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>


<span class="token comment">//液晶定位</span>
<span class="token keyword">void</span> <span class="token function">LCD_pos</span><span class="token punctuation">(</span><span class="token keyword">uint8_t</span> line<span class="token punctuation">,</span><span class="token keyword">uint8_t</span> row<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
	<span class="token keyword">uint8_t</span> pos<span class="token punctuation">;</span>
	pos<span class="token operator">=</span>row<span class="token operator">-</span><span class="token number">1</span><span class="token operator">+</span><span class="token punctuation">(</span>line<span class="token operator">==</span><span class="token number">1</span><span class="token operator">?</span><span class="token number">0x00</span><span class="token operator">:</span><span class="token number">0x40</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">LCD_wcmd</span><span class="token punctuation">(</span>pos<span class="token operator">|</span><span class="token number">0x80</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>


<span class="token comment">//LCD显示</span>
<span class="token keyword">void</span> <span class="token function">LCD_deplay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
	<span class="token function">LCD_clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>


<span class="token comment">//初始化</span>
<span class="token keyword">void</span> <span class="token function">LCD_init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
	<span class="token function">LCD_wcmd</span><span class="token punctuation">(</span><span class="token number">0x38</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//16*2显示，5*7,8位数据</span>
	<span class="token function">LCD_wcmd</span><span class="token punctuation">(</span><span class="token number">0x0c</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//开关光标</span>
	<span class="token function">LCD_wcmd</span><span class="token punctuation">(</span><span class="token number">0x06</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//写完一个字符，地址指针加1</span>
	<span class="token function">LCD_wcmd</span><span class="token punctuation">(</span><span class="token number">0x01</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//清屏</span>
<span class="token punctuation">&#125;</span></code></pre></p>
<h3 id="UART通信"><a href="#UART通信" class="headerlink" title="UART通信"></a>UART通信</h3><p>UART即通用异步收发传输器（Universal Asynchronous Receiver/Transmitter)</p>
<h4 id="通信"><a href="#通信" class="headerlink" title="通信"></a>通信</h4><p>将信息从一方准确安全地传送到另一方</p>
<p>在单片机系统中通信方式可以进行如下划分：</p>
<p>按传输方式划分：</p>
<p><strong>单工</strong>、<strong>半双工</strong>、<strong>全双工</strong></p>
<p>单工方式：数据仅按一个固定方向传送。因而 这种传输方式的用途有限，常用于串行口的打印数 据传输与简单系统间的数据采集。 </p>
<p>半双工方式：数据可实现双向传送，但不能同时进行，实际的应用采用某种协议实现收/发开关转换。（传呼机）</p>
<p> 全双工方式：允许双方同时进行数据双向传送, 但一般全双工传输方式的线路和设备较复杂。</p>
<hr>
<p>按数据传送方式划分：</p>
<p><strong>并行通信</strong>、<strong>串行通信</strong></p>
<p>并行通信通常是将数据字节的各位用多条数据线同时进行传送 。<br><img src="https://www.hualigs.cn/image/606179084b807.jpg" alt="" loading="lazy"><br>并行通信控制简单、传输速度快；但由于传输线较多，长距离传送时成本高且接收方的各位同时接收存在困难。由于长距离，通信介质的传输速度不能保证100%完全相同，因此同时接收对介质硬件要求很高。</p>
<p>串行通信则是将数据字节各位一位一位发送。<br><img src="https://www.hualigs.cn/image/60617a3e57797.jpg" alt="" loading="lazy"><br>串行通信所用传输线少，长距离传送时成 本低，且可以利用电话网等现成的设备，但数据的传送控制（实现方式）比并行通信复杂。</p>
<hr>
<p>其中串行通信按两台机器时钟是否同步划分：</p>
<p><strong>异步通信</strong>、<strong>同步通信</strong></p>
<h4 id="比特率-amp-波特率"><a href="#比特率-amp-波特率" class="headerlink" title="比特率&amp;波特率"></a>比特率&amp;波特率</h4><p>比特率是每秒钟传输二进制代码的位数，单位是<strong>位/秒（bps即bit per second）</strong>。</p>
<hr>
<p>波特率表示每秒钟调制信号变化的次数，单位是<strong>波特（baud)</strong>。</p>
<hr>
<p>对于将数字信号1或0直接用两种不同电压表示的所谓基带传输，比特率和波特率是相同的。所以，在单片机系统中，我们也经常用波特率表示数据的传输速率。</p>
<p>一般的，有:</p>
<p>$S=B*log_2N$</p>
<p>其中，S表示比特率，B表示波特率，N表示一个脉冲信号表示的有效状态（在单片机通信系统中N=2,因此S=B，N&gt;2的时候波特率就比比特率小）</p>
<h4 id="80C51串行口结构"><a href="#80C51串行口结构" class="headerlink" title="80C51串行口结构"></a>80C51串行口结构</h4><p><img src="https://www.hualigs.cn/image/60618e477b7ed.jpg" alt="" loading="lazy"></p>
<p>有两个物理上独立的接收、发送缓冲器SBUF，在逻辑上，它们有相同的名字，并且占用同一地址99H ；但是不会 出现冲突，因为在物理上面，发送SBUF只能被CPU写入数 据，接收SBUF只能被CPU读入数据。 只要TI或者RI为1就进入串口中断。</p>
<h4 id="中断允许寄存器（IE）"><a href="#中断允许寄存器（IE）" class="headerlink" title="中断允许寄存器（IE）"></a>中断允许寄存器（IE）</h4><p>见上文</p>
<h4 id="串行口控制寄存器（SCON）"><a href="#串行口控制寄存器（SCON）" class="headerlink" title="串行口控制寄存器（SCON）"></a>串行口控制寄存器（SCON）</h4><p><img src="https://www.hualigs.cn/image/60618600129e9.jpg" alt="" loading="lazy"></p>
<p>其中SM0和SM1为工作方式选择位，可选择4种工作方式。</p>
<p><img src="https://www.hualigs.cn/image/606186e43d389.jpg" alt="" loading="lazy"></p>
<p>这里重点掌握工作方式1</p>
<p>工作方式1是10位数据的异步通信口。TXD为数据发送引脚，RXD为数据接受引脚，传送一帧数据的格式如图所示。其中1位起始位，8位数据位，1位停止位。</p>
<p><img src="https://www.hualigs.cn/image/60618dd63af6d.jpg" alt="" loading="lazy"></p>
<p>REN是允许串行接收位。由软件设置REN=1，则启动串行口接收数据，若设置为0则禁止接收。</p>
<p>TI，发送中断标志位。在方式0时，当串行发送第8位数据结束时，或在其它方式，串行发送停止位的开始时，由内部硬件使TI置1，向CPU发中断申请。在中断服务程序中，必须用软件将其清0，取消此中断申请。 </p>
<p>RI，接收中断标志位。在方式0时，当串行接收第8位数据结束时，或在其它方式，串行接收停止位的中间时，由内部硬件使RI置1，向CPU发中断申请。也必须在中断服务程序中，用软件将其清0，取消此中断申请。</p>
<p>SM2，TB8，RB8在工作方式1中没有使用。不在此详细说明。</p>
<h4 id="电源控制寄存器（PCON）"><a href="#电源控制寄存器（PCON）" class="headerlink" title="电源控制寄存器（PCON）"></a>电源控制寄存器（PCON）</h4><p><img src="https://www.hualigs.cn/image/60618db3e5f35.jpg" alt="" loading="lazy"></p>
<p>SMOD为波特率倍增位。在串行口 方式1、方式2、方式3时，波特率与SMOD有关， 当SMOD=1时，波特率提高一倍。复位时， SMOD=0。</p>
<h4 id="波特率计算"><a href="#波特率计算" class="headerlink" title="波特率计算"></a>波特率计算</h4><p>在串行通信中，收发双方对发送或接收数据的速率要有约定。通过软件可对单片机串行口编程为四种工作方式，其中方式0和方式2的波特率是固定的，而方式1和方式3的波特率是可变的，由定时器 T1的溢出率来决定。 串行口的四种工作方式对应三种波特率。由于输入的移位时钟的来源不同，所以，各种方式的波特率计算公式也不相同。</p>
<p> 方式0的波特率 = fosc/12</p>
<p> <strong>方式1的波特率 =（2^SMOD/32）·（T1溢出率）</strong> </p>
<p> 方式2的波特率 =（2^SMOD/64）· fosc</p>
<p> 方式3的波特率 =（2^SMOD/32）·（T1溢出率）</p>
<p>当T1作为波特率发生器时，最典型的用法是使 T1工作在自动再装入的8位定时器方式（即方式2， 且TCON的TR1=1，以启动定时器）。这时溢出率取决于TH1中的计数值。 工作在方式2的时候，定时器不需要重装初值， TL1在溢出时候由硬件自动将TH1的值装入到TL1， 因此省略软件重赋初值的时间，定时更加准确。 因为计时器在这里就是工具人作用其中断中不需要有任何操作，使用工作方式2还可以直接略去计时器部分的程序书写。</p>
<p>显然有：</p>
<p>溢出一次所需单位时间=1/单位时间/溢出率</p>
<p>移项即可得：</p>
<p><strong>T1 溢出率 = fosc /12（单位时间倒数）/[256 －（TL1）]（溢出一次所需单位时间） </strong>在单片机的应用中，常用的晶振频率为： 12MHz和11.0592MHz。所以，选用的波特率也相对固定。</p>
<p>假设单片机工作在串口方式1下，波特率设定 为4800bps，系统晶振频率是12M，取SMOD=1， 那么TH1和TL1的值应该为： 方式1的波特率 =（2SMOD/32）·（T1溢出率） T1 溢出率 = fosc /{12×[256 －（TL1）]} 计算得到TL1约为0xF3 但是在同样的条件下，假设单片机的晶振频率 为11.0592M，计算得到的TL1的值为精准的0xF4。</p>
<p>参考代码<br><pre class="language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">//串口中断服务函数</span>
<span class="token keyword">void</span> <span class="token function">UART_RX</span><span class="token punctuation">(</span><span class="token punctuation">)</span> interrupt <span class="token number">4</span><span class="token punctuation">&#123;</span>
	<span class="token keyword">static</span> <span class="token keyword">uint8_t</span> cnt<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">uint8_t</span> Temp<span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>RI<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
		RI<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>    <span class="token comment">//接收中断标志位清零</span>
		Temp<span class="token operator">=</span>SBUF<span class="token punctuation">;</span><span class="token comment">//从接收缓存读数据到Temp</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>cnt<span class="token operator">==</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token function">LCD_pos</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>cnt<span class="token operator">==</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
			<span class="token function">LCD_clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">LCD_pos</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			cnt<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>
		<span class="token function">LCD_wdat</span><span class="token punctuation">(</span>Temp<span class="token punctuation">)</span><span class="token punctuation">;</span>
		cnt<span class="token operator">++</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>


<span class="token keyword">void</span> <span class="token function">UART_init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
	SCON<span class="token operator">=</span><span class="token number">0x50</span><span class="token punctuation">;</span>  <span class="token comment">//串口工作在方式1，数据位8位，使能接受</span>
	TMOD<span class="token operator">=</span><span class="token number">0x20</span><span class="token punctuation">;</span>  <span class="token comment">//定时器T1方式2</span>
	PCON<span class="token operator">|=</span><span class="token number">0x80</span><span class="token punctuation">;</span> <span class="token comment">//波特率倍增，波特率=溢出率/16</span>
	TH1<span class="token operator">=</span><span class="token number">0xf3</span><span class="token punctuation">;</span>   <span class="token comment">//波特率4800</span>
	TL1<span class="token operator">=</span><span class="token number">0xf3</span><span class="token punctuation">;</span>   <span class="token comment">//</span>
	EA<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>       <span class="token comment">//打开总中断</span>
	ES<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>       <span class="token comment">//打开串口中断</span>
	TR1<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>      <span class="token comment">//T1开始计数</span>
<span class="token punctuation">&#125;</span></code></pre><br>中断程序自由发挥。</p>
<h3 id="看门狗"><a href="#看门狗" class="headerlink" title="看门狗"></a>看门狗</h3><p>程序运行时，由于外界电磁场（或者自己写程序作死时），会使程序运行偏离正常路径，往往会造成死循环的后果。</p>
<p>所以出于对单片机运行状态进行实时监测的考虑，便产生了一种专门用于监测单片机程序运行状态的硬件芯片，俗称“看门狗”(watch dog)。</p>
<p>STC系列单片机内部就有看门狗，对看门狗特殊功能寄存器设置即可实现看门狗应用。</p>
<h4 id="看门狗定时器寄存器（Watch-Dog-Timer）"><a href="#看门狗定时器寄存器（Watch-Dog-Timer）" class="headerlink" title="看门狗定时器寄存器（Watch Dog Timer）"></a>看门狗定时器寄存器（Watch Dog Timer）</h4><p><img src="https://www.hualigs.cn/image/60619a594f2d6.jpg" alt="" loading="lazy"></p>
<p>字节地址为E1H，此寄存器<strong>不能位寻址</strong>。</p>
<p>EN_WDT：看门狗允许位，设为1时启动看门狗。</p>
<p>CLR_WDT：看门狗清零位，当设为“1”时，看门狗定时器将重新计数。硬件自动清“0“此位。</p>
<p>（零和”0”有不同含义，一个是定时器，一个是此位)</p>
<p>IDLE_WDT：看门狗“IDLE”模式位，当设置为1时，看门狗定时器在单片机的“idle模式”计数，当清0该位时, 看门狗定时器在单片机的“idle模式”时不计数。</p>
<p>（idle也就是待机模式,进入该模式,片内振荡器并没被冻结,冻结的是CPU,时钟信号依然能提供给中断逻辑,串行口和定时器,由于中断逻辑没被冻结,所以只要有任何一个允许的中断请求被响应,芯片内部马上强制退出待机模式,进入中断服务。此模式可PCON有关）</p>
<p>PS0、PS1、PS2：看门狗定时器预分频值。</p>
<p><img src="https://www.hualigs.cn/image/60619c14a25e2.jpg" alt="" loading="lazy"></p>
<p>看门狗溢出时间公式如下：<br><strong>看门狗溢出时间=(N×预分频数×32768)/晶振频率</strong></p>
<p>N代表单片机在工作时候一个机器周期需要耗费N个时钟周期</p>
<p>参考代码：<br><pre class="language-cpp" data-language="cpp"><code class="language-cpp">sfr WDT_CONTR<span class="token operator">=</span><span class="token number">0xe1</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
	WDT_CONTR<span class="token operator">=</span><span class="token number">0x35</span><span class="token punctuation">;</span> <span class="token comment">//看门狗定时器溢出时间是2s</span>
	<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
		<span class="token function">delay_ms</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		WDT_CONTR<span class="token operator">=</span><span class="token number">0x35</span><span class="token punctuation">;</span> <span class="token comment">//每隔1000ms喂狗一次，因此程序不会被看门狗复位</span>
	<span class="token punctuation">&#125;</span> 
<span class="token punctuation">&#125;</span></code></pre></p>
<h3 id="IIC通信-amp-AT24C02"><a href="#IIC通信-amp-AT24C02" class="headerlink" title="IIC通信&amp;AT24C02"></a>IIC通信&amp;AT24C02</h3><h4 id="IIC"><a href="#IIC" class="headerlink" title="IIC"></a>IIC</h4><p>IIC是一种串行总线。</p>
<p><img src="https://www.hualigs.cn/image/6061b836628ac.jpg" alt="" loading="lazy"></p>
<p>IIC总线有两根双向信号线。一根是数据线SDA，另一根是时钟线SCL。</p>
<p><img src="https://www.hualigs.cn/image/6061b93a69999.jpg" alt="" loading="lazy"></p>
<p>I2C总线通过上拉电阻接正电源。当总线空闲时，两根线均为高电平。连到总线上的任一器件输出的低电平，都将使总线的信号变低，即各器件的SDA及SCL都是线“与”关系。</p>
<h5 id="数据有效性规定"><a href="#数据有效性规定" class="headerlink" title="数据有效性规定"></a>数据有效性规定</h5><p>I2C总线进行数据传送时，时钟信号为高电平期间，数据线上的数据必须保持稳定，只有在时钟线上的信号为低电平期间，数据线上的高电平或低电平状态才允许变化</p>
<p>可以用此图理解：</p>
<p><img src="https://www.hualigs.cn/image/6061ba69b1d19.jpg" alt="" loading="lazy"></p>
<h5 id="起始和终止信号"><a href="#起始和终止信号" class="headerlink" title="起始和终止信号"></a>起始和终止信号</h5><p>SCL线为高电平期间，SDA线由高电平向低电平的变化表示起始信号；SCL线为高电平期间，SDA线由低电平向高电平的变化表示终止信号。</p>
<p>如图所示：</p>
<p><img src="https://www.hualigs.cn/image/6061bb46b0a84.jpg" alt="" loading="lazy"></p>
<h5 id="数据传送格式"><a href="#数据传送格式" class="headerlink" title="数据传送格式"></a>数据传送格式</h5><p>1、字节传送</p>
<p>每一个字节必须保证是8位长度。数据传送时，<strong>先传送最高位（MSB）</strong>，每一个被传送的字节后面都必须跟随一位应答位（即一帧共有9位）。</p>
<p><img src="https://www.hualigs.cn/image/6061bc69ac866.jpg" alt="" loading="lazy"></p>
<p>2、应答<br>主机发送数据给从机，主机对从机发一个字节之后，主机要读取从机的响应信号(主机读SDA线)<br>A) 主机读SDA为高电平，说明从机无应答<br>B) 主机读SDA为低电平，说明从机有应答</p>
<p>从机发送数据给主机， 主机读取从机一个字节之后，主机要向从机发送一个响应信号(主机写SDA线)<br>A) 主机写SDA为高电平，从机收到主机的无应答信号之后，从机停止传输，等待主机的停止信号。<br>B) 主机写SDA为低电平，从机收到主机的应答信号之后，从机继续输出下一字节。</p>
<p>3、数据帧格式</p>
<p>有两种即地址数据帧和真正的数据帧。</p>
<p>地址数据帧格式如下：</p>
<p><img src="https://www.hualigs.cn/image/6061be9c7b267.jpg" alt="" loading="lazy"></p>
<p>第0位表示数据传送方向，为0表示主机向从机写数据，为1表示主机从从机读读数据。</p>
<p>在起始信号后必须传送一个从机的地址（7位），第8位是数据的传送方向位（R/W），用“0”表示主机发送数据（T），“1”表示主机接收数据（R）。每次数据传送总是由主机产生的终止信号结束。但是，若主机希望继续占用总线进行新的数据传送，则可以不产生终止信号，马上再次发出起始信号对另一从机进行寻址。</p>
<h5 id="数据组合"><a href="#数据组合" class="headerlink" title="数据组合"></a>数据组合</h5><p>在总线的一次数据传送过程中，可以有以下几种组合方式：</p>
<p>1、主机向从机发送数据，数据传送方向在整个过程中不变。</p>
<p><img src="https://www.hualigs.cn/image/6061c09af2427.jpg" alt="" loading="lazy"></p>
<p>2、主机在第一个字节后，立即由从机读数据</p>
<p><img src="https://www.hualigs.cn/image/6061c0da1cece.jpg" alt="" loading="lazy"></p>
<p>3、在传送过程中，当需要改变传送方向时，起始信号和从机地址都被重复产生一次，但两次读/写方向位正好相反。</p>
<p><img src="https://www.hualigs.cn/image/6061c0ff9fb62.jpg" alt="" loading="lazy"></p>
<p>（灰色代表主-&gt;从，白色相反。A代表有效应答，A上带横代表无效应答）</p>
<h5 id="总线数据传送的模拟"><a href="#总线数据传送的模拟" class="headerlink" title="总线数据传送的模拟"></a>总线数据传送的模拟</h5><p>主机可以采用不带I2C总线接口的单片机，如80C51、AT89C2051等单片机，利用软件实现I2C总线的数据传送，即软件与硬件结合的信号模拟。</p>
<h5 id="典型信号模拟"><a href="#典型信号模拟" class="headerlink" title="典型信号模拟"></a>典型信号模拟</h5><p>为了保证数据传送的可靠性，标准的I2C总线的数据传送有严格的时序要求。I2C总线的起始信号、终止信号、发送“0”及发送“1”的模拟时序</p>
<p><img src="https://www.hualigs.cn/image/6061c3657f56a.jpg" alt="" loading="lazy"></p>
<h4 id="AT24C02"><a href="#AT24C02" class="headerlink" title="AT24C02"></a>AT24C02</h4><p>AT24C02就是单片机外接的一种储存芯片。用于解决单片机掉电或复位时丢失数据的问题。</p>
<p><img src="https://www.hualigs.cn/image/6061c424255ea.jpg" alt="" loading="lazy"></p>
<p>各引脚功能为：</p>
<p>1,2,3（A0，A1，A2）：可编程地址输入端。A2 A1 A0引脚接高、低电平后得到确定的三位编码,与1010形成7位编码,即为该器件的地址码。对于本人使用的单片机A0，A1，A2均为0。</p>
<p>4（GND）：电源地</p>
<p>5（SDA）：串行数据输入/输出端</p>
<p>6（SCL）：串行时钟输入端</p>
<p>7（HOLD）：写保护输入端，用于硬件数据保护。当其为低电平的时候，可以对整个存储器进行正常的读写操作；当其为高电平的时候，存储器具有写保护的功能，但是不影响读操作。</p>
<p>8（VCC）：电源正</p>
<h5 id="芯片地址"><a href="#芯片地址" class="headerlink" title="芯片地址"></a>芯片地址</h5><p><img src="https://www.hualigs.cn/image/6061c57d91c08.jpg" alt="" loading="lazy"></p>
<p>AT24C02的芯片地址（0xa0为写，0xa1为读）</p>
<h5 id="写"><a href="#写" class="headerlink" title="写"></a>写</h5><p>单片机进行写操作时，首先发送该器件7位地址码和写方向位“0”（共8位，即一个字节），发送完后释放SDA线并在SCL线上产生第9个时钟信号（见字节传送的图）。被选中的存储器器件在确认是自己的地址后，在SDA线上产生一个应答信号作为响应，单片机收到应答后就可以传送数据了。发送完器件的硬件地址，AT24C02芯片应答之后，单片机再次发送要写入的AT24C02内部的地址（256字节），然后发送一个8位有效数据，从机应答后该数据就被写入AT24C02内部，实现掉电存储。当要写入的数据传送完后，单片机应发出终止信号以结束写入操作。</p>
<h5 id="读"><a href="#读" class="headerlink" title="读"></a>读</h5><p>读取过程分两步执行：伪写：单片机先发送该器件的7位地址码和写方向位“0”，发送完后释放SDA线并在SCL线上产生第9个时钟信号。被选中的存储器器件在确认是自己的地址后，在SDA线上产生一个应答信号作为响应，之后单片机再发送寻址数据给AT24C02，以确定想要读取的地址数据。然后，单片机要重复发送一次起始信号并发出器件地址和读方向位（“1”），收到器件应答后就可以读出数据字节，读取完一个字节之后，单片机应返回以“非应答”（高电平），并发出终止信号以结束读出操作。</p>
<p>参考代码<br><pre class="language-cpp" data-language="cpp"><code class="language-cpp">sbit IIC_SCL<span class="token operator">=</span>P3<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">;</span>
sbit IIC_SDA<span class="token operator">=</span>P3<span class="token operator">^</span><span class="token number">3</span><span class="token punctuation">;</span>
<span class="token keyword">uint8_t</span> ADD_RD<span class="token operator">=</span><span class="token number">0XA1</span><span class="token punctuation">;</span>
<span class="token keyword">uint8_t</span> ADD_WR<span class="token operator">=</span><span class="token number">0XA0</span><span class="token punctuation">;</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression"><span class="token function">IIC_delay</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token function">_nop_</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </span><span class="token punctuation">\</span>
                      <span class="token expression"><span class="token function">_nop_</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </span><span class="token punctuation">\</span>
                      <span class="token expression"><span class="token function">_nop_</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </span><span class="token punctuation">\</span>
                      <span class="token expression"><span class="token function">_nop_</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </span><span class="token punctuation">\</span>
                      <span class="token expression"><span class="token function">_nop_</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span></span></span>

<span class="token comment">//产生I2C起始信号</span>
<span class="token keyword">void</span> <span class="token function">IIC_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    IIC_SCL <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">//时钟总线为高电平</span>
    IIC_SDA <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">//数据总线为高电平</span>
    <span class="token function">IIC_delay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//延时，起始条件建立时间</span>
    IIC_SDA <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">//拉低数据总线，产生电平跳变</span>
    <span class="token function">IIC_delay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//延时，起始条件保持时间</span>
    IIC_SCL <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">//拉低时钟总线，允许数据变化</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">//产生I2C停止信号</span>
<span class="token keyword">void</span> <span class="token function">IIC_stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    IIC_SCL <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">//时钟总线为低电平</span>
    IIC_SDA <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">//数据总线为低电平</span>
    <span class="token function">IIC_delay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//延时，停止条件建立</span>
    IIC_SCL <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">//拉高时钟总线</span>
    <span class="token function">IIC_delay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//延时，总线释放</span>
    IIC_SDA <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">//数据总线跳为高电平</span>
    <span class="token function">IIC_delay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//延时，为下一次做准备</span>
    IIC_SCL <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">//拉低时钟总线，允许数据变化</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">//应答</span>
<span class="token keyword">void</span> <span class="token function">IIC_ack</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    IIC_SDA <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    IIC_SCL <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token function">IIC_delay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    IIC_SCL <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    IIC_SDA <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">//非应答</span>
<span class="token keyword">void</span> <span class="token function">IIC_nack</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    IIC_SDA <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    IIC_SCL <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token function">IIC_delay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    IIC_SCL <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    IIC_SDA <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">//等待从机应答.</span>
<span class="token keyword">void</span> <span class="token function">IIC_waitack</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">uint8_t</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
    IIC_SCL <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token function">IIC_delay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>IIC_SDA<span class="token operator">==</span><span class="token number">1</span><span class="token operator">&amp;&amp;</span>i<span class="token operator">&lt;</span><span class="token number">250</span><span class="token punctuation">)</span>i<span class="token operator">++</span><span class="token punctuation">;</span>
    IIC_SCL <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">//主机发送一个字节数据到IIC总线</span>
<span class="token keyword">void</span> <span class="token function">IIC_send_byte</span><span class="token punctuation">(</span><span class="token keyword">uint8_t</span> Data<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">uint8_t</span> mask<span class="token operator">=</span><span class="token number">0x80</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token punctuation">;</span>mask<span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">;</span>mask<span class="token operator">>>=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        IIC_SCL <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>          <span class="token comment">//允许数据变化，进行一次数据传输</span>
        <span class="token function">IIC_delay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        IIC_SDA<span class="token operator">=</span><span class="token punctuation">(</span>mask<span class="token operator">&amp;</span>Data<span class="token punctuation">)</span><span class="token operator">?</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token function">IIC_delay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        IIC_SCL <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>          <span class="token comment">//拉高SCL</span>
        <span class="token function">IIC_delay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    IIC_SCL <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>              <span class="token comment">//再拉低SCL，完成位周期</span>
<span class="token punctuation">&#125;</span>


<span class="token comment">//读取IIC总线上的一个字节数据</span>
<span class="token keyword">uint8_t</span> <span class="token function">IIC_read_byte</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">uint8_t</span> mask<span class="token operator">=</span><span class="token number">0x80</span><span class="token punctuation">,</span>Data<span class="token operator">=</span><span class="token number">0x00</span><span class="token punctuation">;</span>
    IIC_SDA <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>               <span class="token comment">//主机释放SDA</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token punctuation">;</span>mask<span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">;</span>mask<span class="token operator">>>=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        IIC_SCL <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>          <span class="token comment">//不允许数据变化，读取数据</span>
        <span class="token function">IIC_delay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Data<span class="token operator">|=</span><span class="token punctuation">(</span>IIC_SDA<span class="token operator">?</span>mask<span class="token operator">:</span><span class="token number">0x00</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//读取SDA的值，并置位data响应位</span>
        <span class="token function">IIC_delay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        IIC_SCL <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>          <span class="token comment">//拉低SCL，为下一次数据读取做准备</span>
        <span class="token function">IIC_delay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> Data<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">//主机向从机写入数据</span>
<span class="token keyword">void</span> <span class="token function">write_to_ROM</span><span class="token punctuation">(</span><span class="token keyword">uint8_t</span> <span class="token operator">*</span>Data<span class="token punctuation">,</span><span class="token keyword">uint8_t</span> Address<span class="token punctuation">,</span><span class="token keyword">uint8_t</span> Num<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">uint8_t</span> i<span class="token punctuation">;</span>
    <span class="token keyword">uint8_t</span> <span class="token operator">*</span>PData<span class="token punctuation">;</span>
    PData<span class="token operator">=</span>Data<span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>Num<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token function">IIC_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token comment">//发送起始信号</span>
        <span class="token function">IIC_send_byte</span><span class="token punctuation">(</span>ADD_WR<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">//发送控制字节</span>
        <span class="token function">IIC_waitack</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token comment">//等待从机响应</span>
        <span class="token function">IIC_send_byte</span><span class="token punctuation">(</span>Address<span class="token operator">+</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//写入存储地址0X00-0XFF</span>
        <span class="token function">IIC_waitack</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token comment">//等待从机响应</span>
        <span class="token function">IIc_send_byte</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span>PData<span class="token operator">+</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//写数据</span>
        <span class="token function">IIC_waitack</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token comment">//等待从机响应</span>
        <span class="token function">IIC_stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment">//发送停止信号</span>
        <span class="token function">IIC_delay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">//主机读取从机数据</span>
<span class="token keyword">void</span> <span class="token function">read_from_ROM</span><span class="token punctuation">(</span><span class="token keyword">uint8_t</span> <span class="token operator">*</span>Data<span class="token punctuation">,</span><span class="token keyword">uint8_t</span> Address<span class="token punctuation">,</span><span class="token keyword">uint8_t</span> Num<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">uint8_t</span> i<span class="token punctuation">;</span>
    <span class="token keyword">uint8_t</span> <span class="token operator">*</span>PData<span class="token punctuation">;</span>
    PData<span class="token operator">=</span>Data<span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>Num<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token function">IIC_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token comment">//发送起始信号</span>
        <span class="token function">IIC_send_byte</span><span class="token punctuation">(</span>ADD_WR<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">//发送控制字节，写地址找芯片</span>
        <span class="token function">IIC_wait_ack</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">//等待应答</span>
        <span class="token function">IIC_send_byte</span><span class="token punctuation">(</span>Address<span class="token operator">+</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//写入存储地址</span>
        <span class="token function">IIC_waitack</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token comment">//等待从机应答</span>

        <span class="token function">IIC_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token comment">//发送起始信号</span>
        <span class="token function">IIC_send_byte</span><span class="token punctuation">(</span>ADD_RD<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">//发送控制字节，找芯片/读</span>
        <span class="token function">IIC_waitack</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token comment">//等待应答</span>
        <span class="token operator">*</span><span class="token punctuation">(</span>PData<span class="token operator">+</span>i<span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">IIC_read_byte</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//读数据</span>
        IIC_SCL <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>               <span class="token comment">//拉低SCL，数据可改变，为读取下一位数据作准备</span>
        <span class="token function">IIC_nack</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment">//读完该字节，无需发数据</span>
        <span class="token function">IIC_stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment">//停止信号</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code></pre></p>
<h3 id="单总线通信-amp-DS18B20"><a href="#单总线通信-amp-DS18B20" class="headerlink" title="单总线通信&amp;DS18B20"></a>单总线通信&amp;DS18B20</h3><p>这里推荐一个良心视屏<br> <a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1dt411D7JQ?from=search&amp;seid=18327138921932434747">51单片机_DS18B20数字温度计模块</a></p>
<h4 id="单总线"><a href="#单总线" class="headerlink" title="单总线"></a>单总线</h4><p>也是一种总线技术但与IIC不同。如同它的名字一样，单总线通信技术只用一根信号线，既传输时钟又传输数据。自然地这种技术具有节省I/O口，结构简单等优点。不可避免的其时序更加严格。</p>
<p>跟IIC一样，单总线通常要求外接一个约为4.7k的上拉电阻，这样，当总线闲置时，其状态为高电平。</p>
<p>主机和从机之间的通信可通过3个步骤完成，分别为初始化One-Wire（单总线）器件、识别One-Wire器件和交换数据</p>
<h4 id="DS18B20"><a href="#DS18B20" class="headerlink" title="DS18B20"></a>DS18B20</h4><p>温度传感器。会采集周围环境温度并将其转换为二进制数。储存在自带scrathpad中。</p>
<p><img src="https://www.hualigs.cn/image/6063081b75da2.jpg" alt="" loading="lazy"></p>
<p>从手册上可以得知温度储存在scrathpad的前两个字节。</p>
<p><img src="https://www.hualigs.cn/image/6063088d79e5f.jpg" alt="" loading="lazy"></p>
<p>前两字节数据意义如下。 高8位上的S用来表示温度符号S=0则温度为正，S=1温度为负。<strong>温度用补码表示</strong>。</p>
<p>了解了数据的存放，接下来要做的事就是取出数据。</p>
<p><img src="https://www.hualigs.cn/image/60630a3051e2d.jpg" alt="" loading="lazy"></p>
<p>手册上提供了BEH这个命令来读取scrathpad中的数据。根据手册上说的发送命令后会返回9字节数据。因为只需要前两个字节，所以可以就只读两个字节。</p>
<p><img src="https://www.hualigs.cn/image/60630bbd029c9.jpg" alt="" loading="lazy"></p>
<p>read scratchpads是功能命令。但是手册上说在使用功能命令之前还有两个步骤：1初始化、2ROM命令（每个从机有一个确定的ROM地址，用此命令确定从机的ROM地址）。</p>
<p><img src="https://www.hualigs.cn/image/60630cad658f8.jpg" alt="" loading="lazy"></p>
<p>这是一个ROM命令：如果单总线上只有一个从机，可直接使用这个ROM命令忽略ROM地址与这仅有的从机通信。</p>
<p>很幸运，直接用这个就行。</p>
<h4 id="时序-1"><a href="#时序-1" class="headerlink" title="时序"></a>时序</h4><p>有三种时序，初始化时序，读时序，写时序。</p>
<p><img src="https://www.hualigs.cn/image/606311566f04f.jpg" alt="" loading="lazy"></p>
<p>由图，初始化需要先将总线拉低，然后释放总线，等待60~75μm(要大于从机等待时间的最大值，小于从机发送脉冲所需时间最小值）。然后检测从机是否将总线拉低，如果拉低说明从机应答，就可以读取数据了。</p>
<p><img src="https://www.hualigs.cn/image/60631195379c9.jpg" alt="" loading="lazy"></p>
<p>写数据时，主机先将总线拉低。15μm后主机发送数据（0是低电平，1是高电平）然后拉高。</p>
<p>读数据时，主机先将总线拉低，然后释放总线，若DS18B20发送的数据是0，则会在主机拉低总线后15μm保持总线为低电平。若发送的是1则不拉低释放的总线电平。</p>
<h4 id="85°？"><a href="#85°？" class="headerlink" title="85°？"></a>85°？</h4><p>为什么读到的温度都是85°？</p>
<p><img src="https://www.hualigs.cn/image/60630f506504f.jpg" alt="" loading="lazy"></p>
<p>这是因为DS18B20默认处于idle模式（见看门狗部分），需要功能命令<strong>44h</strong>。</p>
<p><img src="https://www.hualigs.cn/image/606310f2a6dbb.jpg" alt="" loading="lazy"></p>
<h4 id="Task"><a href="#Task" class="headerlink" title="Task"></a>Task</h4><p>在LCD1602上显示温度。</p>
<p>主函数代码</p>
<pre class="language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"main.h"</span></span>

<span class="token keyword">void</span> <span class="token function">deplay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
	<span class="token keyword">uint16_t</span> t<span class="token operator">=</span><span class="token function">DS18B20_read_temperature</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">uint8_t</span> th<span class="token punctuation">,</span>tl<span class="token punctuation">;</span>
	<span class="token function">LCD_clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>t<span class="token operator">&amp;</span><span class="token number">0x8000</span><span class="token punctuation">)</span><span class="token function">LCD_wdat</span><span class="token punctuation">(</span><span class="token string">'-'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>t<span class="token operator">=</span><span class="token operator">~</span>t<span class="token punctuation">,</span>t<span class="token operator">+=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token comment">//把补码转化</span>
	<span class="token keyword">else</span> <span class="token function">LCD_wdat</span><span class="token punctuation">(</span><span class="token string">'+'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	th<span class="token operator">=</span>t<span class="token operator">>></span><span class="token number">4</span><span class="token punctuation">;</span>tl<span class="token operator">=</span>t<span class="token operator">&amp;</span><span class="token number">0x0f</span><span class="token punctuation">;</span>
	<span class="token function">LCD_wdat</span><span class="token punctuation">(</span>th<span class="token operator">/</span><span class="token number">100</span><span class="token operator">+</span><span class="token string">'0'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">LCD_wdat</span><span class="token punctuation">(</span>th<span class="token operator">/</span><span class="token number">10</span><span class="token operator">%</span><span class="token number">10</span><span class="token operator">+</span><span class="token string">'0'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">LCD_wdat</span><span class="token punctuation">(</span>th<span class="token operator">%</span><span class="token number">10</span><span class="token operator">+</span><span class="token string">'0'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">LCD_wdat</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">LCD_wdat</span><span class="token punctuation">(</span>tl<span class="token operator">*</span><span class="token number">6</span><span class="token operator">/</span><span class="token number">10</span><span class="token operator">+</span><span class="token string">'0'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">//计算小数的大概值</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">//主函数</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
	<span class="token function">LCD_init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
		<span class="token function">deplay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">delay_ms</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code></pre>
<p>SD18B20</p>
<pre class="language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"DS18B20.h"</span></span>

<span class="token keyword">uint8_t</span> <span class="token function">DS18B20_init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
	<span class="token keyword">uint8_t</span> x<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
	DQ<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>			<span class="token comment">//DQ复位</span>
	<span class="token function">delay_10us</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">//延时610us</span>
	DQ<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>			<span class="token comment">//单片机将DQ拉低</span>
	<span class="token function">delay_10us</span><span class="token punctuation">(</span><span class="token number">48</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">//480us延时</span>
	DQ<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>			<span class="token comment">//拉高总线</span>
	<span class="token function">delay_10us</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">//延时60us</span>
	x<span class="token operator">=</span>DQ<span class="token punctuation">;</span>			<span class="token comment">//稍做延时后 如果x=0则初始化成功 x=1则初始化失败	</span>
	<span class="token function">delay_10us</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">//延时50us</span>
	<span class="token keyword">return</span> x<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">//读一个字节</span>
<span class="token keyword">uint8_t</span> <span class="token function">DS18B20_read_byte</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
	<span class="token keyword">uint8_t</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>dat<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">;</span>i<span class="token operator">>=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">--</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
		DQ<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>				<span class="token comment">//拉低DQ</span>
		dat<span class="token operator">>>=</span><span class="token number">1</span><span class="token punctuation">;</span>			<span class="token comment">//右移1位</span>
		DQ<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>				<span class="token comment">//释放DQ</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>DQ<span class="token punctuation">)</span>dat<span class="token operator">|=</span><span class="token number">0x80</span><span class="token punctuation">;</span>	<span class="token comment">//将读取的1数据保存到dat的最高位</span>
		<span class="token function">delay_10us</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">//延时30us</span>
	<span class="token punctuation">&#125;</span>
	<span class="token keyword">return</span> dat<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">//写一个字节</span>
<span class="token keyword">void</span> <span class="token function">DS18B20_write_byte</span><span class="token punctuation">(</span><span class="token keyword">uint8_t</span> dat<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
	<span class="token keyword">uint8_t</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">;</span>i<span class="token operator">>=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">--</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
		DQ<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
		DQ<span class="token operator">=</span>dat<span class="token operator">&amp;</span><span class="token number">0x01</span><span class="token punctuation">;</span>	<span class="token comment">//将dat的最低位输出到单总线</span>
		<span class="token function">delay_10us</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">//延时30us</span>
		DQ<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>			<span class="token comment">//DQ拉高释放总线</span>
		dat<span class="token operator">>>=</span><span class="token number">1</span><span class="token punctuation">;</span>		<span class="token comment">//dat数据右移1位</span>
	<span class="token punctuation">&#125;</span>	
	<span class="token function">delay_10us</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">//延时30us</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">//读取温度</span>
<span class="token keyword">uint16_t</span> <span class="token function">DS18B20_read_temperature</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
	<span class="token keyword">uint16_t</span> byte0<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>byte1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>t<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token function">DS18B20_init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>				<span class="token comment">//初始化DS18B20</span>
	<span class="token function">DS18B20_write_byte</span><span class="token punctuation">(</span><span class="token number">0xCC</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">//跳过读序号列号的操作</span>
	<span class="token function">DS18B20_write_byte</span><span class="token punctuation">(</span><span class="token number">0x44</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//启动温度转换</span>
	<span class="token function">delay_ms</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>				<span class="token comment">//延时200ms</span>
	<span class="token function">DS18B20_init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>				<span class="token comment">//初始化DS18B20</span>
	<span class="token function">DS18B20_write_byte</span><span class="token punctuation">(</span><span class="token number">0xCC</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//跳过读序号列号的操作 </span>
	<span class="token function">DS18B20_write_byte</span><span class="token punctuation">(</span><span class="token number">0xBE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//读取温度寄存器等（共可读9个寄存器）前两个就是温度</span>
	byte0<span class="token operator">=</span><span class="token function">DS18B20_read_byte</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">//读暂存器的第1个字节，温度的低位</span>
	byte1<span class="token operator">=</span><span class="token function">DS18B20_read_byte</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   	<span class="token comment">//读暂存器的第2个字节，温度的高位</span>
	byte1<span class="token operator">&lt;&lt;=</span><span class="token number">8</span><span class="token punctuation">;</span>
	t<span class="token operator">=</span>byte0<span class="token operator">+</span>byte1<span class="token punctuation">;</span>
	<span class="token keyword">return</span> t<span class="token punctuation">;</span>						<span class="token comment">//返回16位温度值</span>
<span class="token punctuation">&#125;</span></code></pre>
<p>其中sbit DQ=P3^7;</p>
</div><div id="reward-container"><span class="hty-icon-button button-glow" id="reward-button" title="打赏" onclick="var qr = document.getElementById(&quot;qr&quot;); qr.style.display = (qr.style.display === &quot;none&quot;) ? &quot;block&quot; : &quot;none&quot;;"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-hand-coin-line"></use></svg></span><div id="reward-comment">I'm so cute. Please give me money.</div><div id="qr" style="display:none;"><div style="display:inline-block"><a target="_blank" rel="noopener" href="https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/donate/alipay-qrcode.jpg"><img loading="lazy" src="https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/donate/alipay-qrcode.jpg" alt="支付宝" title="支付宝"></a><div><span style="color:#00A3EE"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-alipay-line"></use></svg></span></div></div><div style="display:inline-block"><a target="_blank" rel="noopener" href="https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/donate/qqpay-qrcode.png"><img loading="lazy" src="https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/donate/qqpay-qrcode.png" alt="QQ 支付" title="QQ 支付"></a><div><span style="color:#12B7F5"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-qq-line"></use></svg></span></div></div><div style="display:inline-block"><a target="_blank" rel="noopener" href="https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/donate/wechatpay-qrcode.jpg"><img loading="lazy" src="https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/donate/wechatpay-qrcode.jpg" alt="微信支付" title="微信支付"></a><div><span style="color:#2DC100"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-wechat-pay-line"></use></svg></span></div></div></div></div><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者：</strong>xudaxia</li><li class="post-copyright-link"><strong>本文链接：</strong><a href="http://example.com/2021/01/21/AT89C52%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" title="AT89C52学习笔记">http://example.com/2021/01/21/AT89C52%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</a></li><li class="post-copyright-license"><strong>版权声明：</strong>本博客所有文章除特别声明外，均默认采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><svg class="icon"><use xlink:href="#icon-creative-commons-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-by-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-nc-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-sa-line"></use></svg></a> 许可协议。</li></ul></section></article><div class="post-nav"><div class="post-nav-item"><a class="post-nav-prev" href="/2021/03/18/%E6%A8%A1%E5%9D%97%E5%8C%96%E7%BC%96%E7%A8%8B/" rel="prev" title="模块化编程"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-left-s-line"></use></svg><span class="post-nav-text">模块化编程</span></a></div><div class="post-nav-item"><a class="post-nav-next" href="/2020/12/17/%E6%8C%87%E9%92%88%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%8C%E4%B8%8D%E4%BB%85%E4%BB%85%E6%98%AF%E6%8C%87%E9%92%88/" rel="next" title="指针学习笔记，不仅仅是指针"><span class="post-nav-text">指针学习笔记，不仅仅是指针</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-right-s-line"></use></svg></a></div></div></div><div id="comment"><div class="comment-tooltip text-center"><span>点击按钮跳转 GitHub Issues 评论。</span><br><span>若没有本文 Issue，您可以使用 Comment 模版新建。</span><br><a class="hty-button hty-button--raised" id="github-issues" target="_blank" rel="noopener" href="https://github.com/YunYouJun/yunyoujun.github.io/issues?q=is:issue+AT89C52学习笔记">GitHub Issues</a></div></div></main><footer class="sidebar-translate" id="footer"><div class="copyright"><span>&copy; 2019 – 2021 </span><span class="with-love" id="animate"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-cloud-line"></use></svg></span><span class="author"> xudaxia</span></div><div class="powered"><span>由 <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> 驱动 v5.2.0</span><span class="footer-separator">|</span><span>主题 - <a rel="noopener" href="https://github.com/YunYouJun/hexo-theme-yun" target="_blank"><span>Yun</span></a> v1.3.0</span></div></footer><a class="hty-icon-button" id="goUp" aria-label="back-to-top" href="#"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-up-s-line"></use></svg><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#0078E7" stroke-width="2" stroke-linecap="round"></circle></svg></a></div><script defer src="/js/utils.js"></script><script defer src="/js/hexo-theme-yun.js"></script></body></html>